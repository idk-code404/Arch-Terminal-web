<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arch Linux Terminal</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: 'JetBrains Mono', monospace;
            background: #1a1a2e;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        .terminal {
            background: #0d0d0d;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            max-width: 1200px;
            margin: 0 auto;
            height: calc(100vh - 40px);
            display: flex;
            flex-direction: column;
        }
        .terminal-header {
            background: linear-gradient(to bottom, #3c3c3c, #2a2a2a);
            padding: 10px 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            border-bottom: 1px solid #1a1a1a;
        }
        .terminal-btn {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
        }
        .btn-close { background: #ff5f56; }
        .btn-minimize { background: #ffbd2e; }
        .btn-maximize { background: #27ca3f; }
        .terminal-title {
            color: #aaa;
            font-size: 13px;
            margin-left: 10px;
        }
        .terminal-body {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            color: #c8c8c8;
            font-size: 14px;
            line-height: 1.5;
        }
        .terminal-body::-webkit-scrollbar { width: 8px; }
        .terminal-body::-webkit-scrollbar-track { background: #1a1a1a; }
        .terminal-body::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }
        .output-line { white-space: pre-wrap; word-break: break-all; }
        .prompt { color: #1793d1; font-weight: bold; }
        .prompt-user { color: #27ca3f; }
        .prompt-path { color: #1793d1; }
        .input-line { display: flex; align-items: center; }
        #command-input {
            background: transparent;
            border: none;
            color: #fff;
            font-family: inherit;
            font-size: 14px;
            flex: 1;
            outline: none;
            caret-color: #1793d1;
        }
        .error { color: #ff5f56; }
        .success { color: #27ca3f; }
        .info { color: #1793d1; }
        .warning { color: #ffbd2e; }
        .directory { color: #1793d1; font-weight: bold; }
        .executable { color: #27ca3f; }
        .file { color: #c8c8c8; }
        .ascii-art { color: #1793d1; }
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="terminal">
        <div class="terminal-header">
            <button class="terminal-btn btn-close"></button>
            <button class="terminal-btn btn-minimize"></button>
            <button class="terminal-btn btn-maximize"></button>
            <span class="terminal-title">arch@localhost: ~</span>
        </div>
        <div class="terminal-body" id="terminal-body">
            <div id="output"></div>
            <div class="input-line">
                <span id="prompt"></span>
                <input type="text" id="command-input" autofocus autocomplete="off" spellcheck="false">
            </div>
        </div>
    </div>

    <script>
        // Virtual File System
        const fileSystem = {
            '/': { type: 'dir', children: ['bin', 'boot', 'dev', 'etc', 'home', 'lib', 'mnt', 'opt', 'proc', 'root', 'run', 'srv', 'sys', 'tmp', 'usr', 'var'] },
            '/home': { type: 'dir', children: ['arch'] },
            '/home/arch': { type: 'dir', children: ['.bashrc', '.config', 'Documents', 'Downloads', 'Pictures', 'Music', 'Videos', 'projects', 'README.md'] },
            '/home/arch/.bashrc': { type: 'file', content: '# ~/.bashrc\n\nalias ls=\'ls --color=auto\'\nalias grep=\'grep --color=auto\'\nPS1=\'[\\u@\\h \\W]\\$ \'\n\nexport EDITOR=vim\nexport PATH="$HOME/.local/bin:$PATH"' },
            '/home/arch/.config': { type: 'dir', children: ['nvim', 'i3', 'alacritty'] },
            '/home/arch/Documents': { type: 'dir', children: ['notes.txt', 'todo.md'] },
            '/home/arch/Documents/notes.txt': { type: 'file', content: 'My Arch Linux Notes\n===================\n\n1. Remember to update system regularly: sudo pacman -Syu\n2. AUR helper: yay or paru\n3. Check wiki: wiki.archlinux.org\n\nKeep it simple, keep it Arch!' },
            '/home/arch/Documents/todo.md': { type: 'file', content: '# TODO List\n\n- [x] Install Arch Linux\n- [x] Configure i3wm\n- [ ] Setup development environment\n- [ ] Learn more about systemd\n- [ ] Contribute to AUR' },
            '/home/arch/Downloads': { type: 'dir', children: [] },
            '/home/arch/Pictures': { type: 'dir', children: ['wallpaper.png', 'screenshot.png'] },
            '/home/arch/Music': { type: 'dir', children: [] },
            '/home/arch/Videos': { type: 'dir', children: [] },
            '/home/arch/projects': { type: 'dir', children: ['hello.py', 'server.js', 'Makefile'] },
            '/home/arch/projects/hello.py': { type: 'file', content: '#!/usr/bin/env python3\n\ndef main():\n    print("Hello from Arch Linux!")\n    print("BTW, I use Arch.")\n\nif __name__ == "__main__":\n    main()' },
            '/home/arch/projects/server.js': { type: 'file', content: 'const http = require(\'http\');\n\nconst server = http.createServer((req, res) => {\n    res.writeHead(200, {\'Content-Type\': \'text/plain\'});\n    res.end(\'Hello from Arch Linux Server!\\n\');\n});\n\nserver.listen(3000, () => {\n    console.log(\'Server running at http://localhost:3000/\');\n});' },
            '/home/arch/projects/Makefile': { type: 'file', content: 'CC=gcc\nCFLAGS=-Wall -Wextra -O2\n\nall: main\n\nmain: main.c\n\t$(CC) $(CFLAGS) -o main main.c\n\nclean:\n\trm -f main' },
            '/home/arch/README.md': { type: 'file', content: '# Welcome to Arch Linux Terminal Emulator\n\nThis is a simulated Arch Linux terminal running in your browser.\n\n## Available Commands\n\n- `ls` - list directory contents\n- `cd` - change directory\n- `pwd` - print working directory\n- `cat` - display file contents\n- `echo` - display text\n- `clear` - clear terminal\n- `neofetch` - system info\n- `pacman` - package manager\n- `help` - show all commands\n\n## Fun Fact\n\nBTW, I use Arch.' },
            '/etc': { type: 'dir', children: ['pacman.conf', 'fstab', 'hostname', 'hosts', 'passwd'] },
            '/etc/hostname': { type: 'file', content: 'archlinux' },
            '/etc/hosts': { type: 'file', content: '127.0.0.1\tlocalhost\n::1\t\tlocalhost\n127.0.1.1\tarchlinux.localdomain\tarchlinux' },
            '/bin': { type: 'dir', children: ['bash', 'ls', 'cat', 'pwd', 'echo', 'grep', 'sed', 'awk'] },
            '/usr': { type: 'dir', children: ['bin', 'lib', 'share', 'local'] },
            '/tmp': { type: 'dir', children: [] },
            '/var': { type: 'dir', children: ['log', 'cache', 'tmp'] },
        };

        // Terminal State
        let currentPath = '/home/arch';
        let commandHistory = [];
        let historyIndex = -1;
        const username = 'arch';
        const hostname = 'archlinux';
        let env = { HOME: '/home/arch', USER: 'arch', SHELL: '/bin/bash', PATH: '/usr/local/bin:/usr/bin:/bin', TERM: 'xterm-256color', EDITOR: 'vim' };

        // Installed packages - this SET tracks what's installed
        let installedPackages = new Set([
            'base', 'base-devel', 'bash', 'coreutils', 'filesystem', 'gcc', 'git', 
            'linux', 'neovim', 'nodejs', 'pacman', 'python', 'vim'
        ]);

        // All available packages with their info and commands
        const allPackages = {
            // Pre-installed
            'nodejs': { version: '21.6.2-1', size: '45.2 MiB', desc: 'JavaScript runtime', commands: ['node', 'npm', 'npx'] },
            'python': { version: '3.11.8-1', size: '55.3 MiB', desc: 'Python programming language', commands: ['python', 'python3', 'pip', 'pip3'] },
            'git': { version: '2.44.0-1', size: '32.1 MiB', desc: 'Version control system', commands: ['git'] },
            'vim': { version: '9.1.0135-1', size: '12.5 MiB', desc: 'Vi Improved text editor', commands: ['vim', 'vi'] },
            'neovim': { version: '0.9.5-4', size: '25.3 MiB', desc: 'Vim-fork focused on extensibility', commands: ['nvim'] },
            'gcc': { version: '13.2.1-5', size: '120.5 MiB', desc: 'GNU Compiler Collection', commands: ['gcc', 'g++', 'cc'] },
            
            // Installable packages
            'htop': { version: '3.3.0-1', size: '0.3 MiB', desc: 'Interactive process viewer', commands: ['htop'] },
            'btop': { version: '1.3.0-1', size: '2.1 MiB', desc: 'A monitor of resources', commands: ['btop'] },
            'firefox': { version: '124.0-1', size: '78.5 MiB', desc: 'Standalone web browser from mozilla.org', commands: ['firefox'] },
            'chromium': { version: '122.0.6261.94-1', size: '95.2 MiB', desc: 'Web browser built for speed and security', commands: ['chromium'] },
            'discord': { version: '0.0.45-1', size: '120.3 MiB', desc: 'All-in-one voice and text chat', commands: ['discord'] },
            'spotify': { version: '1.2.31-1', size: '150.8 MiB', desc: 'A proprietary music streaming service', commands: ['spotify'] },
            'vlc': { version: '3.0.20-4', size: '45.6 MiB', desc: 'Multi-platform MPEG, VCD/DVD, and DivX player', commands: ['vlc', 'cvlc'] },
            'docker': { version: '25.0.3-1', size: '52.1 MiB', desc: 'Container platform', commands: ['docker', 'dockerd'] },
            'code': { version: '1.87.0-1', size: '120.5 MiB', desc: 'Visual Studio Code', commands: ['code'] },
            'steam': { version: '1.0.0.79-1', size: '4.2 MiB', desc: 'Valve\'s digital software delivery system', commands: ['steam'] },
            'rust': { version: '1.76.0-1', size: '180.3 MiB', desc: 'Systems programming language', commands: ['rustc', 'cargo', 'rustup'] },
            'go': { version: '1.22.0-1', size: '145.2 MiB', desc: 'Go programming language', commands: ['go', 'gofmt'] },
            'nginx': { version: '1.24.0-2', size: '1.2 MiB', desc: 'HTTP server and reverse proxy', commands: ['nginx'] },
            'postgresql': { version: '16.2-1', size: '25.8 MiB', desc: 'Sophisticated object-relational DBMS', commands: ['psql', 'postgres', 'pg_dump'] },
            'redis': { version: '7.2.4-1', size: '2.1 MiB', desc: 'In-memory database', commands: ['redis-server', 'redis-cli'] },
            'mysql': { version: '8.0.36-1', size: '180.5 MiB', desc: 'MySQL database server', commands: ['mysql', 'mysqld', 'mysqldump'] },
            'mongodb': { version: '7.0.5-1', size: '150.2 MiB', desc: 'NoSQL document database', commands: ['mongod', 'mongo', 'mongosh'] },
            'zsh': { version: '5.9-4', size: '3.2 MiB', desc: 'Z shell', commands: ['zsh'] },
            'fish': { version: '3.7.0-1', size: '8.5 MiB', desc: 'Friendly interactive shell', commands: ['fish'] },
            'tmux': { version: '3.4-1', size: '0.8 MiB', desc: 'Terminal multiplexer', commands: ['tmux'] },
            'screen': { version: '4.9.1-1', size: '0.9 MiB', desc: 'Terminal multiplexer', commands: ['screen'] },
            'wget': { version: '1.21.4-1', size: '3.1 MiB', desc: 'Network utility to retrieve files', commands: ['wget'] },
            'curl': { version: '8.6.0-1', size: '4.5 MiB', desc: 'Command line data transfer tool', commands: ['curl'] },
            'ripgrep': { version: '14.1.0-1', size: '2.8 MiB', desc: 'Fast search tool', commands: ['rg', 'ripgrep'] },
            'fzf': { version: '0.46.1-1', size: '1.5 MiB', desc: 'Command-line fuzzy finder', commands: ['fzf'] },
            'bat': { version: '0.24.0-1', size: '2.3 MiB', desc: 'Cat clone with syntax highlighting', commands: ['bat'] },
            'exa': { version: '0.10.1-4', size: '0.8 MiB', desc: 'Modern ls replacement', commands: ['exa'] },
            'eza': { version: '0.18.0-1', size: '0.9 MiB', desc: 'Modern ls replacement (exa fork)', commands: ['eza'] },
            'fd': { version: '9.0.0-1', size: '1.2 MiB', desc: 'Simple, fast find alternative', commands: ['fd'] },
            'neofetch': { version: '7.1.0-2', size: '0.1 MiB', desc: 'CLI system information tool', commands: ['neofetch'] },
            'fastfetch': { version: '2.8.0-1', size: '0.5 MiB', desc: 'Fast system info tool', commands: ['fastfetch'] },
            'gimp': { version: '2.10.36-3', size: '125.4 MiB', desc: 'GNU Image Manipulation Program', commands: ['gimp'] },
            'blender': { version: '4.0.2-3', size: '320.5 MiB', desc: '3D graphics creation suite', commands: ['blender'] },
            'inkscape': { version: '1.3.2-1', size: '95.3 MiB', desc: 'Vector graphics editor', commands: ['inkscape'] },
            'obs-studio': { version: '30.0.2-2', size: '85.2 MiB', desc: 'Streaming/recording software', commands: ['obs'] },
            'ffmpeg': { version: '6.1.1-1', size: '15.8 MiB', desc: 'Complete multimedia framework', commands: ['ffmpeg', 'ffprobe', 'ffplay'] },
            'mpv': { version: '0.37.0-1', size: '2.5 MiB', desc: 'Media player', commands: ['mpv'] },
            'youtube-dl': { version: '2021.12.17-1', size: '3.2 MiB', desc: 'YouTube video downloader', commands: ['youtube-dl'] },
            'yt-dlp': { version: '2024.03.10-1', size: '4.1 MiB', desc: 'YouTube video downloader (fork)', commands: ['yt-dlp'] },
            'jq': { version: '1.7.1-1', size: '0.4 MiB', desc: 'JSON processor', commands: ['jq'] },
            'yq': { version: '4.42.1-1', size: '3.5 MiB', desc: 'YAML processor', commands: ['yq'] },
            'tree': { version: '2.1.1-1', size: '0.1 MiB', desc: 'Directory listing as tree', commands: ['tree'] },
            'ncdu': { version: '2.3-1', size: '0.2 MiB', desc: 'NCurses Disk Usage', commands: ['ncdu'] },
            'duf': { version: '0.8.1-1', size: '1.5 MiB', desc: 'Disk Usage/Free Utility', commands: ['duf'] },
            'dust': { version: '0.9.0-1', size: '1.2 MiB', desc: 'du + rust = dust', commands: ['dust'] },
            'procs': { version: '0.14.4-1', size: '1.8 MiB', desc: 'Modern ps replacement', commands: ['procs'] },
            'lazygit': { version: '0.40.2-1', size: '8.5 MiB', desc: 'Simple terminal UI for git', commands: ['lazygit'] },
            'lazydocker': { version: '0.23.1-1', size: '9.2 MiB', desc: 'Simple terminal UI for docker', commands: ['lazydocker'] },
            'neovim': { version: '0.9.5-4', size: '25.3 MiB', desc: 'Vim-fork focused on extensibility', commands: ['nvim'] },
            'emacs': { version: '29.2-1', size: '180.5 MiB', desc: 'Extensible text editor', commands: ['emacs'] },
            'nano': { version: '7.2-1', size: '2.8 MiB', desc: 'Simple text editor', commands: ['nano'] },
            'helix': { version: '24.03-1', size: '15.2 MiB', desc: 'Post-modern text editor', commands: ['hx', 'helix'] },
            'micro': { version: '2.0.13-1', size: '10.5 MiB', desc: 'Modern terminal text editor', commands: ['micro'] },
            'kubectl': { version: '1.29.2-1', size: '45.3 MiB', desc: 'Kubernetes CLI', commands: ['kubectl'] },
            'helm': { version: '3.14.2-1', size: '32.1 MiB', desc: 'Kubernetes package manager', commands: ['helm'] },
            'terraform': { version: '1.7.4-1', size: '75.8 MiB', desc: 'Infrastructure as Code', commands: ['terraform'] },
            'ansible': { version: '9.3.0-1', size: '85.2 MiB', desc: 'IT automation platform', commands: ['ansible', 'ansible-playbook'] },
            'aws-cli': { version: '2.15.21-1', size: '120.5 MiB', desc: 'AWS Command Line Interface', commands: ['aws'] },
            'gcloud': { version: '466.0.0-1', size: '250.3 MiB', desc: 'Google Cloud CLI', commands: ['gcloud'] },
            'azure-cli': { version: '2.58.0-1', size: '180.2 MiB', desc: 'Azure Command Line Interface', commands: ['az'] },
            'make': { version: '4.4.1-1', size: '1.5 MiB', desc: 'GNU make utility', commands: ['make'] },
            'cmake': { version: '3.28.3-1', size: '35.2 MiB', desc: 'Cross-platform build system', commands: ['cmake'] },
            'meson': { version: '1.3.2-1', size: '8.5 MiB', desc: 'High productivity build system', commands: ['meson'] },
            'ninja': { version: '1.11.1-1', size: '0.3 MiB', desc: 'Small build system', commands: ['ninja'] },
            'clang': { version: '17.0.6-1', size: '250.5 MiB', desc: 'C/C++/Objective-C compiler', commands: ['clang', 'clang++'] },
            'llvm': { version: '17.0.6-1', size: '350.2 MiB', desc: 'Compiler infrastructure', commands: ['llc', 'lli', 'llvm-config'] },
            'java-runtime': { version: '21-1', size: '180.5 MiB', desc: 'Java Runtime Environment', commands: ['java'] },
            'jdk': { version: '21-1', size: '320.8 MiB', desc: 'Java Development Kit', commands: ['java', 'javac', 'jar'] },
            'maven': { version: '3.9.6-1', size: '12.5 MiB', desc: 'Java project management', commands: ['mvn'] },
            'gradle': { version: '8.6-1', size: '125.3 MiB', desc: 'Build automation tool', commands: ['gradle'] },
            'php': { version: '8.3.3-1', size: '25.8 MiB', desc: 'PHP scripting language', commands: ['php'] },
            'composer': { version: '2.7.1-1', size: '2.5 MiB', desc: 'PHP dependency manager', commands: ['composer'] },
            'ruby': { version: '3.3.0-1', size: '35.2 MiB', desc: 'Ruby programming language', commands: ['ruby', 'irb', 'gem'] },
            'perl': { version: '5.38.2-1', size: '55.8 MiB', desc: 'Perl programming language', commands: ['perl'] },
            'lua': { version: '5.4.6-1', size: '0.5 MiB', desc: 'Lua programming language', commands: ['lua'] },
            'r': { version: '4.3.3-1', size: '85.2 MiB', desc: 'R programming language', commands: ['R', 'Rscript'] },
            'julia': { version: '1.10.2-1', size: '450.3 MiB', desc: 'Julia programming language', commands: ['julia'] },
            'kotlin': { version: '1.9.22-1', size: '65.8 MiB', desc: 'Kotlin programming language', commands: ['kotlin', 'kotlinc'] },
            'scala': { version: '3.3.3-1', size: '45.2 MiB', desc: 'Scala programming language', commands: ['scala', 'scalac'] },
            'elixir': { version: '1.16.1-1', size: '12.5 MiB', desc: 'Elixir programming language', commands: ['elixir', 'iex', 'mix'] },
            'erlang': { version: '26.2.2-1', size: '85.3 MiB', desc: 'Erlang programming language', commands: ['erl', 'erlc'] },
            'haskell-ghc': { version: '9.8.1-1', size: '850.5 MiB', desc: 'Haskell compiler', commands: ['ghc', 'ghci'] },
            'ocaml': { version: '5.1.1-1', size: '125.8 MiB', desc: 'OCaml programming language', commands: ['ocaml', 'ocamlc'] },
            'zig': { version: '0.11.0-1', size: '45.2 MiB', desc: 'Zig programming language', commands: ['zig'] },
            'nim': { version: '2.0.2-1', size: '35.8 MiB', desc: 'Nim programming language', commands: ['nim', 'nimble'] },
            'deno': { version: '1.41.0-1', size: '85.2 MiB', desc: 'JavaScript/TypeScript runtime', commands: ['deno'] },
            'bun': { version: '1.0.29-1', size: '45.5 MiB', desc: 'Fast JavaScript runtime', commands: ['bun', 'bunx'] },
            'openssh': { version: '9.6p1-1', size: '5.2 MiB', desc: 'SSH connectivity tools', commands: ['ssh', 'scp', 'sftp', 'ssh-keygen'] },
            'rsync': { version: '3.2.7-1', size: '0.8 MiB', desc: 'Fast file transfer program', commands: ['rsync'] },
            'nmap': { version: '7.95-1', size: '26.1 MiB', desc: 'Network exploration tool and security/port scanner', commands: ['nmap'] },
            'wireshark': { version: '4.2.3-1', size: '85.2 MiB', desc: 'Network protocol analyzer', commands: ['wireshark', 'tshark'] },
            'netcat': { version: '1.226-1', size: '0.1 MiB', desc: 'Network utility', commands: ['nc', 'netcat'] },
            'iproute2': { version: '6.7.0-1', size: '2.5 MiB', desc: 'IP routing utilities', commands: ['ip', 'ss'] },
            'bind': { version: '9.18.24-1', size: '15.8 MiB', desc: 'DNS server and tools', commands: ['dig', 'nslookup', 'host'] },
            'whois': { version: '5.5.22-1', size: '0.3 MiB', desc: 'WHOIS client', commands: ['whois'] },
            'traceroute': { version: '2.1.3-1', size: '0.1 MiB', desc: 'Network diagnostic tool', commands: ['traceroute'] },
            'mtr': { version: '0.95-1', size: '0.2 MiB', desc: 'Network diagnostic tool', commands: ['mtr'] },
            'sl': { version: '5.05-1', size: '0.1 MiB', desc: 'Steam Locomotive', commands: ['sl'] },
            'cowsay': { version: '3.04-1', size: '0.1 MiB', desc: 'Configurable speaking cow', commands: ['cowsay', 'cowthink'] },
            'fortune': { version: '1.0-1', size: '2.5 MiB', desc: 'Random quotes', commands: ['fortune'] },
            'lolcat': { version: '100.0.1-1', size: '0.2 MiB', desc: 'Rainbow coloring for text', commands: ['lolcat'] },
            'figlet': { version: '2.2.5-1', size: '0.5 MiB', desc: 'ASCII art text', commands: ['figlet'] },
            'toilet': { version: '0.3-1', size: '0.3 MiB', desc: 'ASCII art text with colors', commands: ['toilet'] },
            'cmatrix': { version: '2.0-1', size: '0.1 MiB', desc: 'Matrix screensaver', commands: ['cmatrix'] },
            'pipes.sh': { version: '1.3.0-1', size: '0.1 MiB', desc: 'Animated pipes screensaver', commands: ['pipes.sh', 'pipes'] },
            'asciiquarium': { version: '1.1-1', size: '0.1 MiB', desc: 'ASCII aquarium', commands: ['asciiquarium'] },
            'hollywood': { version: '1.22-1', size: '0.5 MiB', desc: 'Fill your terminal with Hollywood technobabble', commands: ['hollywood'] },

            // ==================== KALI LINUX SECURITY TOOLS ====================
            
            // Information Gathering
            'maltego': { version: '4.6.0-1', size: '250.5 MiB', desc: 'Open source intelligence and graphical link analysis tool', commands: ['maltego'] },
            'recon-ng': { version: '5.1.2-1', size: '15.3 MiB', desc: 'Web reconnaissance framework', commands: ['recon-ng'] },
            'theharvester': { version: '4.4.0-1', size: '8.2 MiB', desc: 'E-mail, subdomain and people names harvester', commands: ['theHarvester', 'theharvester'] },
            'shodan': { version: '1.31.0-1', size: '5.5 MiB', desc: 'Shodan command-line interface', commands: ['shodan'] },
            'spiderfoot': { version: '4.0.0-1', size: '45.2 MiB', desc: 'OSINT automation tool', commands: ['spiderfoot', 'sf'] },
            'dmitry': { version: '1.3a-1', size: '0.2 MiB', desc: 'Deepmagic Information Gathering Tool', commands: ['dmitry'] },
            'fierce': { version: '1.5.0-1', size: '2.1 MiB', desc: 'DNS reconnaissance tool', commands: ['fierce'] },
            'amass': { version: '4.2.0-1', size: '85.3 MiB', desc: 'In-depth Attack Surface Mapping and Asset Discovery', commands: ['amass'] },
            'subfinder': { version: '2.6.5-1', size: '25.2 MiB', desc: 'Subdomain discovery tool', commands: ['subfinder'] },
            'masscan': { version: '1.3.2-1', size: '0.8 MiB', desc: 'TCP port scanner, spews SYN packets asynchronously', commands: ['masscan'] },
            'enum4linux': { version: '0.9.1-1', size: '0.5 MiB', desc: 'Tool for enumerating data from Windows and Samba hosts', commands: ['enum4linux'] },
            'dnsrecon': { version: '1.1.5-1', size: '3.2 MiB', desc: 'DNS enumeration script', commands: ['dnsrecon'] },
            'whatweb': { version: '0.5.5-1', size: '12.5 MiB', desc: 'Next generation web scanner', commands: ['whatweb'] },
            'wafw00f': { version: '2.2.0-1', size: '1.5 MiB', desc: 'Web Application Firewall detection tool', commands: ['wafw00f'] },

            // Vulnerability Analysis
            'nikto': { version: '2.5.0-1', size: '5.8 MiB', desc: 'Web server scanner', commands: ['nikto'] },
            'openvas': { version: '22.7.0-1', size: '450.2 MiB', desc: 'Open Vulnerability Assessment Scanner', commands: ['openvas', 'gvm-start', 'gvm-stop'] },
            'nessus': { version: '10.7.0-1', size: '850.5 MiB', desc: 'Vulnerability scanner', commands: ['nessus', 'nessusd'] },
            'wpscan': { version: '3.8.25-1', size: '35.2 MiB', desc: 'WordPress security scanner', commands: ['wpscan'] },
            'sqlmap': { version: '1.8.2-1', size: '15.8 MiB', desc: 'Automatic SQL injection tool', commands: ['sqlmap'] },
            'lynis': { version: '3.1.1-1', size: '2.5 MiB', desc: 'Security auditing tool for Unix/Linux', commands: ['lynis'] },
            'nuclei': { version: '3.2.0-1', size: '45.2 MiB', desc: 'Fast and customizable vulnerability scanner', commands: ['nuclei'] },
            'vuls': { version: '0.25.0-1', size: '65.3 MiB', desc: 'Agent-less vulnerability scanner', commands: ['vuls'] },
            'trivy': { version: '0.49.0-1', size: '85.2 MiB', desc: 'Container vulnerability scanner', commands: ['trivy'] },
            'grype': { version: '0.74.0-1', size: '45.5 MiB', desc: 'Vulnerability scanner for containers', commands: ['grype'] },

            // Web Application Analysis
            'burpsuite': { version: '2024.2.1-1', size: '550.5 MiB', desc: 'Web security testing toolkit', commands: ['burpsuite', 'burp'] },
            'zaproxy': { version: '2.14.0-1', size: '250.2 MiB', desc: 'OWASP Zed Attack Proxy', commands: ['zaproxy', 'zap', 'owasp-zap'] },
            'gobuster': { version: '3.6.0-1', size: '8.5 MiB', desc: 'Directory/file & DNS busting tool', commands: ['gobuster'] },
            'dirb': { version: '2.22-1', size: '0.5 MiB', desc: 'Web content scanner', commands: ['dirb'] },
            'dirbuster': { version: '1.0-1', size: '15.2 MiB', desc: 'Web server directory brute-forcer', commands: ['dirbuster'] },
            'wfuzz': { version: '3.1.0-1', size: '5.2 MiB', desc: 'Web application fuzzer', commands: ['wfuzz'] },
            'ffuf': { version: '2.1.0-1', size: '8.5 MiB', desc: 'Fast web fuzzer', commands: ['ffuf'] },
            'feroxbuster': { version: '2.10.0-1', size: '12.5 MiB', desc: 'Fast, simple, recursive content discovery tool', commands: ['feroxbuster'] },
            'httpx': { version: '1.3.9-1', size: '25.2 MiB', desc: 'Fast and multi-purpose HTTP toolkit', commands: ['httpx'] },
            'katana': { version: '1.0.5-1', size: '18.5 MiB', desc: 'A next-generation crawling and spidering framework', commands: ['katana'] },
            'arjun': { version: '2.2.1-1', size: '2.5 MiB', desc: 'HTTP parameter discovery suite', commands: ['arjun'] },
            'paramspider': { version: '1.0-1', size: '1.2 MiB', desc: 'Mining parameters from dark corners of Web Archives', commands: ['paramspider'] },

            // Password Attacks
            'john': { version: '1.9.0-1', size: '25.5 MiB', desc: 'John the Ripper password cracker', commands: ['john', 'john-the-ripper'] },
            'hashcat': { version: '6.2.6-1', size: '15.8 MiB', desc: 'Advanced password recovery', commands: ['hashcat'] },
            'hydra': { version: '9.5-1', size: '5.2 MiB', desc: 'Network logon cracker', commands: ['hydra', 'xhydra'] },
            'medusa': { version: '2.2-1', size: '2.5 MiB', desc: 'Speedy, parallel, modular login brute-forcer', commands: ['medusa'] },
            'cewl': { version: '6.1-1', size: '1.5 MiB', desc: 'Custom word list generator', commands: ['cewl'] },
            'crunch': { version: '3.6-1', size: '0.3 MiB', desc: 'Wordlist generator', commands: ['crunch'] },
            'ophcrack': { version: '3.8.0-1', size: '25.2 MiB', desc: 'Windows password cracker using rainbow tables', commands: ['ophcrack'] },
            'rainbowcrack': { version: '1.8-1', size: '5.5 MiB', desc: 'Rainbow table password cracker', commands: ['rtgen', 'rtsort', 'rcrack'] },
            'hash-identifier': { version: '1.2-1', size: '0.2 MiB', desc: 'Hash identification tool', commands: ['hash-identifier', 'hashid'] },
            'patator': { version: '0.9-1', size: '2.5 MiB', desc: 'Multi-purpose brute-forcer', commands: ['patator'] },
            'crowbar': { version: '4.2-1', size: '1.8 MiB', desc: 'Brute forcing tool', commands: ['crowbar'] },
            'ncrack': { version: '0.7-1', size: '3.2 MiB', desc: 'High-speed network authentication cracking tool', commands: ['ncrack'] },

            // Wireless Attacks
            'aircrack-ng': { version: '1.7-1', size: '8.5 MiB', desc: 'WiFi security auditing tools suite', commands: ['aircrack-ng', 'airodump-ng', 'aireplay-ng', 'airmon-ng', 'airdecap-ng', 'packetforge-ng'] },
            'kismet': { version: '2023.07-1', size: '25.2 MiB', desc: 'Wireless network detector and sniffer', commands: ['kismet', 'kismet_server'] },
            'wifite': { version: '2.7.0-1', size: '5.5 MiB', desc: 'Automated wireless auditor', commands: ['wifite', 'wifite2'] },
            'reaver': { version: '1.6.6-1', size: '1.2 MiB', desc: 'WPS brute force attack tool', commands: ['reaver'] },
            'bully': { version: '1.4.0-1', size: '0.8 MiB', desc: 'WPS brute force attack tool', commands: ['bully'] },
            'fern-wifi-cracker': { version: '3.3-1', size: '15.2 MiB', desc: 'Wireless security auditing tool', commands: ['fern-wifi-cracker'] },
            'cowpatty': { version: '4.8-1', size: '0.5 MiB', desc: 'WPA-PSK dictionary attack tool', commands: ['cowpatty'] },
            'pixiewps': { version: '1.4.2-1', size: '0.3 MiB', desc: 'Offline WPS bruteforce tool', commands: ['pixiewps'] },
            'hostapd-wpe': { version: '2.10-1', size: '2.5 MiB', desc: 'Wireless Pwnage Edition', commands: ['hostapd-wpe'] },
            'fluxion': { version: '6.0-1', size: '8.5 MiB', desc: 'WPA security auditing tool with social engineering', commands: ['fluxion'] },

            // Exploitation Tools
            'metasploit': { version: '6.4.0-1', size: '850.5 MiB', desc: 'Penetration testing framework', commands: ['msfconsole', 'msfvenom', 'msfrpcd', 'msfdb', 'msfupdate'] },
            'beef-xss': { version: '0.5.4-1', size: '125.2 MiB', desc: 'Browser Exploitation Framework', commands: ['beef-xss', 'beef'] },
            'exploitdb': { version: '2024.03-1', size: '1250.5 MiB', desc: 'Offensive Security Exploit Database Archive', commands: ['searchsploit'] },
            'setoolkit': { version: '8.0.3-1', size: '85.2 MiB', desc: 'Social Engineering Toolkit', commands: ['setoolkit', 'se-toolkit'] },
            'armitage': { version: '1.5-1', size: '35.2 MiB', desc: 'Graphical cyber attack management tool', commands: ['armitage'] },
            'crackmapexec': { version: '5.4.0-1', size: '45.5 MiB', desc: 'Network information gathering tool', commands: ['crackmapexec', 'cme'] },
            'evil-winrm': { version: '3.5-1', size: '5.2 MiB', desc: 'WinRM shell for hacking/pentesting', commands: ['evil-winrm'] },
            'impacket': { version: '0.11.0-1', size: '25.5 MiB', desc: 'Network protocols Python library', commands: ['impacket-smbserver', 'impacket-wmiexec', 'impacket-psexec', 'impacket-secretsdump', 'impacket-ntlmrelayx'] },
            'covenant': { version: '0.6-1', size: '150.2 MiB', desc: '.NET C2 framework', commands: ['covenant'] },
            'sliver': { version: '1.5.41-1', size: '85.5 MiB', desc: 'Adversary Emulation Framework', commands: ['sliver', 'sliver-server'] },

            // Sniffing & Spoofing
            'ettercap': { version: '0.8.3.1-1', size: '15.5 MiB', desc: 'Comprehensive suite for MITM attacks', commands: ['ettercap', 'ettercap-graphical'] },
            'bettercap': { version: '2.32.0-1', size: '25.2 MiB', desc: 'Network attack and monitoring framework', commands: ['bettercap'] },
            'responder': { version: '3.1.3-1', size: '5.5 MiB', desc: 'LLMNR, NBT-NS and MDNS poisoner', commands: ['responder'] },
            'tcpdump': { version: '4.99.4-1', size: '1.5 MiB', desc: 'Command-line packet analyzer', commands: ['tcpdump'] },
            'dsniff': { version: '2.4-1', size: '2.5 MiB', desc: 'Network auditing tools', commands: ['dsniff', 'arpspoof', 'dnsspoof', 'filesnarf', 'macof', 'mailsnarf', 'msgsnarf', 'sshmitm', 'tcpkill', 'tcpnice', 'urlsnarf', 'webspy'] },
            'mitmproxy': { version: '10.2.2-1', size: '85.2 MiB', desc: 'Interactive TLS-capable intercepting proxy', commands: ['mitmproxy', 'mitmdump', 'mitmweb'] },
            'scapy': { version: '2.5.0-1', size: '15.5 MiB', desc: 'Packet manipulation program', commands: ['scapy'] },
            'yersinia': { version: '0.8.2-1', size: '1.5 MiB', desc: 'Network tool to exploit L2 protocols', commands: ['yersinia'] },
            'macchanger': { version: '1.7.0-1', size: '0.3 MiB', desc: 'MAC address changer', commands: ['macchanger'] },
            'hping3': { version: '3.0-1', size: '0.5 MiB', desc: 'Active network smashing tool', commands: ['hping3'] },

            // Post Exploitation
            'mimikatz': { version: '2.2.0-1', size: '5.5 MiB', desc: 'Windows credential harvesting', commands: ['mimikatz'] },
            'empire': { version: '5.9.0-1', size: '125.2 MiB', desc: 'PowerShell post-exploitation framework', commands: ['empire', 'powershell-empire'] },
            'powersploit': { version: '3.0.0-1', size: '15.5 MiB', desc: 'PowerShell post-exploitation framework', commands: ['powersploit'] },
            'bloodhound': { version: '4.3.1-1', size: '250.2 MiB', desc: 'AD relationship graphing tool', commands: ['bloodhound', 'neo4j'] },
            'sharphound': { version: '2.3.2-1', size: '5.5 MiB', desc: 'C# data collector for BloodHound', commands: ['sharphound'] },
            'linpeas': { version: '1.0-1', size: '1.5 MiB', desc: 'Linux Privilege Escalation Awesome Script', commands: ['linpeas'] },
            'winpeas': { version: '1.0-1', size: '2.5 MiB', desc: 'Windows Privilege Escalation Awesome Script', commands: ['winpeas'] },
            'pspy': { version: '1.2.1-1', size: '3.2 MiB', desc: 'Monitor linux processes without root', commands: ['pspy'] },
            'chisel': { version: '1.9.1-1', size: '8.5 MiB', desc: 'Fast TCP/UDP tunnel over HTTP', commands: ['chisel'] },
            'ligolo-ng': { version: '0.5.1-1', size: '12.5 MiB', desc: 'Advanced tunneling tool', commands: ['ligolo-ng'] },

            // Forensics
            'autopsy': { version: '4.21.0-1', size: '1250.5 MiB', desc: 'Digital forensics platform', commands: ['autopsy'] },
            'binwalk': { version: '2.3.4-1', size: '5.5 MiB', desc: 'Firmware analysis tool', commands: ['binwalk'] },
            'foremost': { version: '1.5.7-1', size: '0.5 MiB', desc: 'Forensic file recovery tool', commands: ['foremost'] },
            'volatility': { version: '3.2.0-1', size: '85.2 MiB', desc: 'Memory forensics framework', commands: ['volatility', 'vol', 'vol3', 'volatility3'] },
            'sleuthkit': { version: '4.12.1-1', size: '15.5 MiB', desc: 'File system forensic analysis tools', commands: ['fls', 'icat', 'mmls', 'fsstat', 'blkcat', 'blkls', 'tsk_recover'] },
            'testdisk': { version: '7.2-1', size: '2.5 MiB', desc: 'Data recovery software', commands: ['testdisk', 'photorec'] },
            'scalpel': { version: '2.0-1', size: '0.5 MiB', desc: 'File carving tool', commands: ['scalpel'] },
            'bulk-extractor': { version: '2.0.0-1', size: '25.5 MiB', desc: 'Extracts information from disk images', commands: ['bulk_extractor'] },
            'exiftool': { version: '12.76-1', size: '8.5 MiB', desc: 'Metadata reader/writer', commands: ['exiftool'] },
            'steghide': { version: '0.5.1-1', size: '0.8 MiB', desc: 'Steganography tool', commands: ['steghide'] },
            'stegseek': { version: '0.6-1', size: '2.5 MiB', desc: 'Lightning fast steghide cracker', commands: ['stegseek'] },
            'zsteg': { version: '0.2.12-1', size: '1.5 MiB', desc: 'PNG/BMP analysis tool', commands: ['zsteg'] },

            // Reverse Engineering
            'ghidra': { version: '11.0.1-1', size: '550.5 MiB', desc: 'Software reverse engineering framework', commands: ['ghidra', 'ghidraRun'] },
            'radare2': { version: '5.8.8-1', size: '25.5 MiB', desc: 'Reverse engineering framework', commands: ['radare2', 'r2', 'rabin2', 'rasm2', 'radiff2'] },
            'gdb': { version: '14.1-1', size: '35.2 MiB', desc: 'GNU Debugger', commands: ['gdb'] },
            'peda': { version: '1.0-1', size: '2.5 MiB', desc: 'Python Exploit Development Assistance for GDB', commands: ['peda'] },
            'gef': { version: '2024.01-1', size: '3.5 MiB', desc: 'GDB Enhanced Features', commands: ['gef'] },
            'pwndbg': { version: '2024.02-1', size: '5.5 MiB', desc: 'GDB plug-in for exploit development', commands: ['pwndbg'] },
            'rizin': { version: '0.7.2-1', size: '28.5 MiB', desc: 'UNIX-like reverse engineering framework', commands: ['rizin', 'rz-bin', 'rz-asm'] },
            'cutter': { version: '2.3.2-1', size: '85.2 MiB', desc: 'Reverse engineering platform powered by rizin', commands: ['cutter'] },
            'apktool': { version: '2.9.3-1', size: '15.5 MiB', desc: 'Android APK reverse engineering tool', commands: ['apktool'] },
            'jadx': { version: '1.4.7-1', size: '25.5 MiB', desc: 'Android DEX to Java decompiler', commands: ['jadx', 'jadx-gui'] },
            'objdump': { version: '2.42-1', size: '5.5 MiB', desc: 'Display info from object files', commands: ['objdump'] },
            'strace': { version: '6.7-1', size: '1.5 MiB', desc: 'System call tracer', commands: ['strace'] },
            'ltrace': { version: '0.7.3-1', size: '0.8 MiB', desc: 'Library call tracer', commands: ['ltrace'] },

            // Reporting
            'dradis': { version: '4.11.0-1', size: '125.5 MiB', desc: 'Collaboration and reporting platform', commands: ['dradis'] },
            'faraday': { version: '5.1.0-1', size: '250.2 MiB', desc: 'Collaborative penetration test IDE', commands: ['faraday', 'faraday-server'] },
            'pipal': { version: '3.1-1', size: '1.5 MiB', desc: 'Password analyzer', commands: ['pipal'] },
            'cherrytree': { version: '1.0.4-1', size: '25.5 MiB', desc: 'Hierarchical note taking application', commands: ['cherrytree'] },

            // Social Engineering  
            'gophish': { version: '0.12.1-1', size: '45.2 MiB', desc: 'Open-source phishing toolkit', commands: ['gophish'] },
            'king-phisher': { version: '1.14.0-1', size: '35.5 MiB', desc: 'Phishing campaign toolkit', commands: ['king-phisher'] },
            'evilginx2': { version: '3.2.0-1', size: '15.5 MiB', desc: 'Man-in-the-middle attack framework', commands: ['evilginx2', 'evilginx'] },
            'modlishka': { version: '1.1.0-1', size: '8.5 MiB', desc: 'Reverse proxy for phishing', commands: ['modlishka'] },

            // Cloud Security
            'cloudsploit': { version: '3.0.0-1', size: '45.2 MiB', desc: 'Cloud security posture management', commands: ['cloudsploit'] },
            'prowler': { version: '4.0.0-1', size: '85.5 MiB', desc: 'AWS/Azure/GCP security tool', commands: ['prowler'] },
            'scoutsuite': { version: '5.14.0-1', size: '55.2 MiB', desc: 'Multi-cloud security auditing tool', commands: ['scout', 'scoutsuite'] },
            'pacu': { version: '1.5.0-1', size: '25.5 MiB', desc: 'AWS exploitation framework', commands: ['pacu'] },
            'cloudfox': { version: '1.13.0-1', size: '35.2 MiB', desc: 'Cloud penetration testing tool', commands: ['cloudfox'] },
        };

        const outputEl = document.getElementById('output');
        const inputEl = document.getElementById('command-input');
        const promptEl = document.getElementById('prompt');
        const terminalBody = document.getElementById('terminal-body');
        const terminalTitle = document.querySelector('.terminal-title');

        function getPrompt() {
            const displayPath = currentPath === '/home/arch' ? '~' : currentPath.startsWith('/home/arch/') ? '~' + currentPath.slice(11) : currentPath;
            return `<span class="prompt-user">${username}@${hostname}</span>:<span class="prompt-path">${displayPath}</span>$ `;
        }

        function updatePrompt() {
            promptEl.innerHTML = getPrompt();
            const displayPath = currentPath === '/home/arch' ? '~' : currentPath.startsWith('/home/arch/') ? '~' + currentPath.slice(11) : currentPath;
            terminalTitle.textContent = `${username}@${hostname}: ${displayPath}`;
        }

        function appendOutput(text, className = '') {
            const line = document.createElement('div');
            line.className = 'output-line' + (className ? ' ' + className : '');
            line.innerHTML = text;
            outputEl.appendChild(line);
            scrollToBottom();
        }

        function appendRaw(text) {
            const line = document.createElement('div');
            line.className = 'output-line';
            line.textContent = text;
            outputEl.appendChild(line);
            scrollToBottom();
        }

        function scrollToBottom() {
            terminalBody.scrollTop = terminalBody.scrollHeight;
        }

        function resolvePath(path) {
            if (path.startsWith('~')) path = '/home/arch' + path.slice(1);
            if (!path.startsWith('/')) path = currentPath + '/' + path;
            const parts = path.split('/').filter(p => p && p !== '.');
            const stack = [];
            for (const part of parts) {
                if (part === '..') stack.pop();
                else stack.push(part);
            }
            return '/' + stack.join('/') || '/';
        }

        function getNode(path) { return fileSystem[path]; }

        // Find which package provides a command
        function findPackageForCommand(cmd) {
            for (const [pkgName, pkg] of Object.entries(allPackages)) {
                if (pkg.commands && pkg.commands.includes(cmd)) {
                    return pkgName;
                }
            }
            return null;
        }

        // Check if a command is available (its package is installed)
        function isCommandAvailable(cmd) {
            const pkg = findPackageForCommand(cmd);
            return pkg && installedPackages.has(pkg);
        }

        // Dynamic command handlers for installed packages
        const packageCommandHandlers = {
            // System monitors
            htop: () => appendOutput(`<span class="success">htop 3.3.0</span> - Interactive Process Viewer\n\n  <span class="info">CPU[||||||||||||||||      52.3%]</span>   Tasks: <span class="success">142</span>, <span class="warning">523</span> thr\n  <span class="info">Mem[||||||||||||         4.2G/16G]</span>   Load: 0.52 0.58 0.59\n  <span class="info">Swp[                     0K/8G]</span>   Uptime: ${Math.floor(Math.random()*10)}:${String(Math.floor(Math.random()*60)).padStart(2,'0')}\n\n  <span class="directory">  PID USER      PRI  NI  VIRT   RES S CPU% Command</span>\n  <span class="success"> 1842 arch       20   0  723M  125M S  8.2 node</span>\n   567 arch       20   0  456M   89M S  3.1 vim\n  1024 arch       20   0  1.2G  234M S  2.4 firefox\n\n<span class="info">Press q to quit (simulated)</span>`),
            
            btop: () => appendOutput(`<span class="info">btop++ 1.3.0</span>\n┌─ <span class="success">CPU</span> ─────────────────────────────────────────────────────┐\n│ <span class="warning">████████████████████░░░░░░░░░░░░░░░░░░░░</span> 52% @ 3.4GHz  │\n└──────────────────────────────────────────────────────────┘\n┌─ <span class="success">MEMORY</span> ────────────────────────────────────────────────────┐\n│ <span class="info">████████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░</span> 4.2G / 16G     │\n└──────────────────────────────────────────────────────────┘`),

            // Browsers
            firefox: () => appendOutput(`<span class="info">Mozilla Firefox 124.0</span>\nLaunching Firefox...\n<span class="success">Firefox is running!</span> (simulated)`),
            chromium: () => appendOutput(`<span class="info">Chromium 122.0.6261.94</span>\nLaunching Chromium...\n<span class="success">Chromium is running!</span> (simulated)`),

            // Chat/Media
            discord: () => appendOutput(`<span class="info">Discord 0.0.45</span>\nStarting Discord...\n<span class="success">Discord is running!</span>\nConnecting to gateway.discord.gg...`),
            spotify: () => appendOutput(`<span class="info">Spotify 1.2.31</span>\n<span class="success">♪ Now Playing:</span> Arch Linux Theme\n<span class="info">Artist:</span> The Terminal Band`),
            vlc: (args) => appendOutput(`<span class="info">VLC media player 3.0.20</span>\n${args[0] ? `Opening: ${args[0]}` : 'Ready to play media'}\n<span class="success">VLC is running!</span>`),
            cvlc: (args) => packageCommandHandlers.vlc(args),
            steam: () => appendOutput(`<span class="info">Steam Client</span>\nConnecting to Steam...\n<span class="success">Steam is running!</span>\nLibrary: 42 games`),
            mpv: (args) => appendOutput(`<span class="info">mpv 0.37.0</span>\n${args[0] ? `Playing: ${args[0]}` : 'Usage: mpv <file>'}`),

            // Docker
            docker: (args) => {
                if (!args.length) appendOutput(`<span class="info">Docker 25.0.3</span>\n\nUsage: docker [command]\n\nCommands:\n  ps        List containers\n  images    List images\n  run       Run a container\n  build     Build an image`);
                else if (args[0] === 'ps') appendOutput(`CONTAINER ID   IMAGE          STATUS        NAMES\na1b2c3d4e5f6   nginx:latest   Up 2 hours    webserver\nf6e5d4c3b2a1   redis:alpine   Up 5 hours    cache`);
                else if (args[0] === 'images') appendOutput(`REPOSITORY   TAG       SIZE\nnginx        latest    142MB\nredis        alpine    32MB\nnode         20        1.1GB`);
                else appendOutput(`<span class="success">docker ${args.join(' ')}</span> executed`);
            },
            dockerd: () => appendOutput(`Docker daemon starting...\n<span class="success">Docker daemon is running</span>`),

            // Code editors
            code: (args) => appendOutput(`<span class="info">Visual Studio Code 1.87.0</span>\nOpening '${args[0] || '.'}' in VS Code...\n<span class="success">VS Code launched!</span>`),
            nvim: (args) => appendOutput(`<span class="info">NVIM v0.9.5</span>\n${args[0] ? `Editing: ${args[0]}` : 'Type :q to exit'}`),
            emacs: (args) => appendOutput(`<span class="info">GNU Emacs 29.2</span>\n${args[0] ? `Editing: ${args[0]}` : 'C-x C-c to exit'}`),
            nano: (args) => appendOutput(`<span class="info">GNU nano 7.2</span>\n${args[0] ? `File: ${args[0]}` : 'New buffer'}\n^X Exit  ^O Save`),
            hx: (args) => appendOutput(`<span class="info">Helix 24.03</span>\n${args[0] ? `Editing: ${args[0]}` : ':q to quit'}`),
            helix: (args) => packageCommandHandlers.hx(args),
            micro: (args) => appendOutput(`<span class="info">micro 2.0.13</span>\n${args[0] ? `Editing: ${args[0]}` : 'Ctrl-Q to quit'}`),
            vim: (args) => appendOutput(`<span class="info">VIM - Vi IMproved 9.1</span>\n${args[0] ? `Editing: ${args[0]}` : ':q to exit'}`),
            vi: (args) => packageCommandHandlers.vim(args),

            // Programming languages
            node: (args) => {
                if (args.includes('--version') || args.includes('-v')) appendOutput('v21.6.2');
                else if (!args.length) appendOutput(`Welcome to Node.js v21.6.2.\n> `);
                else appendOutput(`<span class="success">Running ${args[0]}...</span>\nHello from Node.js!`);
            },
            npm: (args) => {
                if (!args.length) appendOutput(`<span class="info">npm 10.4.0</span>\nUsage: npm <command>\n\nCommands: install, start, run, test`);
                else if (args[0] === 'install' || args[0] === 'i') appendOutput(`<span class="info">npm</span> installing ${args[1] || 'dependencies'}...\nadded ${Math.floor(Math.random()*100+50)} packages`);
                else appendOutput(`npm: ${args.join(' ')} executed`);
            },
            npx: (args) => appendOutput(`<span class="info">npx</span> ${args[0] || 'command'}...`),
            python: (args) => packageCommandHandlers.python3(args),
            python3: (args) => {
                if (args.includes('--version') || args.includes('-V')) appendOutput('Python 3.11.8');
                else if (!args.length) appendOutput(`Python 3.11.8\nType "help" for more information.\n>>> `);
                else appendOutput(`<span class="success">Running ${args[0]}...</span>\nHello from Python!`);
            },
            pip: (args) => {
                if (!args.length) appendOutput(`<span class="info">pip 24.0</span>\nUsage: pip <command>\n\nCommands: install, uninstall, list`);
                else if (args[0] === 'install') appendOutput(`Collecting ${args[1] || 'package'}...\n<span class="success">Successfully installed!</span>`);
                else if (args[0] === 'list') appendOutput(`Package    Version\npip        24.0\nsetuptools 69.1.0`);
                else appendOutput(`pip: ${args.join(' ')} executed`);
            },
            pip3: (args) => packageCommandHandlers.pip(args),
            rustc: (args) => {
                if (args.includes('--version') || args.includes('-V')) appendOutput('rustc 1.76.0');
                else if (!args.length) appendOutput('error: no input filename given', 'error');
                else appendOutput(`<span class="success">Compiling ${args[0]}...</span>\nFinished in 0.42s`);
            },
            cargo: (args) => {
                if (!args.length) appendOutput(`<span class="info">Cargo 1.76.0</span>\nUsage: cargo <command>\n\nCommands: new, build, run, test`);
                else if (args[0] === 'new') appendOutput(`<span class="success">Created</span> package \`${args[1] || 'my_project'}\``);
                else if (args[0] === 'build') appendOutput(`<span class="success">Compiling</span> my_project v0.1.0\n<span class="success">Finished</span> in 1.24s`);
                else if (args[0] === 'run') appendOutput(`<span class="success">Running</span> target/debug/my_project\nHello, world!`);
                else appendOutput(`cargo: ${args.join(' ')} executed`);
            },
            rustup: (args) => appendOutput(`<span class="info">rustup 1.26.0</span>\n${args[0] ? `${args.join(' ')} executed` : 'Usage: rustup <command>'}`),
            go: (args) => {
                if (!args.length) appendOutput(`<span class="info">Go 1.22.0</span>\nUsage: go <command>\n\nCommands: build, run, test, get, mod`);
                else if (args[0] === 'version') appendOutput('go version go1.22.0 linux/amd64');
                else if (args[0] === 'run') appendOutput(`<span class="success">Running...</span>\nHello from Go!`);
                else appendOutput(`go: ${args.join(' ')} executed`);
            },
            gofmt: (args) => appendOutput(`<span class="success">Formatted ${args[0] || 'file.go'}</span>`),
            java: (args) => {
                if (args.includes('-version')) appendOutput('java version "21" 2023-09-19');
                else appendOutput(`<span class="info">Java 21</span>\n${args[0] ? `Running ${args[0]}` : 'Usage: java <class>'}`);
            },
            javac: (args) => appendOutput(`<span class="success">Compiling ${args[0] || 'file.java'}...</span>`),
            php: (args) => {
                if (args.includes('-v')) appendOutput('PHP 8.3.3');
                else appendOutput(`<span class="info">PHP 8.3.3</span>\n${args[0] ? `Running ${args[0]}` : 'Usage: php <file>'}`);
            },
            ruby: (args) => {
                if (args.includes('-v')) appendOutput('ruby 3.3.0');
                else appendOutput(`<span class="info">Ruby 3.3.0</span>\n${args[0] ? `Running ${args[0]}` : 'irb for interactive mode'}`);
            },
            irb: () => appendOutput(`irb(main):001:0> `),
            gem: (args) => appendOutput(`<span class="info">RubyGems 3.5.6</span>\n${args[0] ? `${args.join(' ')} executed` : 'Usage: gem <command>'}`),
            perl: (args) => appendOutput(`<span class="info">Perl 5.38.2</span>\n${args[0] ? `Running ${args[0]}` : 'Usage: perl <file>'}`),
            lua: (args) => appendOutput(`<span class="info">Lua 5.4.6</span>\n${args[0] ? `Running ${args[0]}` : '> '}`),
            julia: (args) => appendOutput(`<span class="info">Julia 1.10.2</span>\n${args[0] ? `Running ${args[0]}` : 'julia> '}`),
            deno: (args) => appendOutput(`<span class="info">Deno 1.41.0</span>\n${args[0] ? `${args.join(' ')} executed` : 'Usage: deno <command>'}`),
            bun: (args) => appendOutput(`<span class="info">Bun 1.0.29</span>\n${args[0] ? `${args.join(' ')} executed` : 'Usage: bun <command>'}`),
            bunx: (args) => appendOutput(`<span class="info">bunx</span> ${args[0] || 'command'}...`),

            // Shell
            zsh: () => appendOutput(`<span class="info">zsh 5.9</span>\nSwitching to Zsh...\n<span class="success">Welcome to Zsh!</span>`),
            fish: () => appendOutput(`<span class="info">fish 3.7.0</span>\nWelcome to fish, the friendly interactive shell`),
            tmux: (args) => {
                if (!args.length || args[0] === 'new') appendOutput(`<span class="info">tmux 3.4</span>\n[New session created]\n┌──────────────────────────────────────────┐\n│ <span class="prompt-user">arch@archlinux</span>:<span class="prompt-path">~</span>$                        │\n├──────────────────────────────────────────┤\n│ [0] 0:bash*                              │\n└──────────────────────────────────────────┘`);
                else if (args[0] === 'ls') appendOutput(`0: 1 windows (attached)`);
                else appendOutput(`tmux: ${args.join(' ')} executed`);
            },
            screen: (args) => appendOutput(`<span class="info">GNU Screen 4.9.1</span>\n${args[0] ? `${args.join(' ')} executed` : '[screen session]'}`),

            // Network tools
            wget: (args) => {
                if (!args.length) { appendOutput('wget: missing URL', 'error'); return; }
                appendOutput(`--${new Date().toISOString()}--  ${args[0]}\nConnecting... <span class="success">connected</span>\nHTTP request sent... <span class="success">200 OK</span>\nSaving to: 'index.html'\n<span class="success">Saved!</span>`);
            },
            curl: (args) => {
                if (!args.length) { appendOutput('curl: try \'curl --help\'', 'error'); return; }
                if (args[0] === '--help' || args[0] === '-h') appendOutput(`Usage: curl [options] <url>\n -o  Write output to file\n -L  Follow redirects\n -s  Silent mode`);
                else appendOutput(`<!DOCTYPE html>\n<html><head><title>Response</title></head>\n<body><h1>Response from ${args.find(a => !a.startsWith('-')) || 'server'}</h1></body></html>`);
            },
            ssh: (args) => appendOutput(`<span class="info">OpenSSH 9.6</span>\n${args[0] ? `Connecting to ${args[0]}...` : 'Usage: ssh user@host'}`),
            scp: (args) => appendOutput(`<span class="info">scp</span> ${args.length ? 'Copying files...' : 'Usage: scp source dest'}`),
            sftp: (args) => appendOutput(`<span class="info">sftp</span> ${args[0] ? `Connected to ${args[0]}` : 'Usage: sftp user@host'}`),
            rsync: (args) => appendOutput(`<span class="info">rsync 3.2.7</span>\n${args.length ? 'Syncing files...\n<span class="success">Done!</span>' : 'Usage: rsync [options] src dest'}`),
            nmap: (args) => {
                const version = '7.95';
                if (!args.length) {
                    appendOutput(`<span class="info">Nmap ${version} ( https://nmap.org )</span>
Usage: nmap [Scan Type(s)] [Options] {target specification}

TARGET SPECIFICATION:
  hostname, IP address, network, etc.
  Ex: scanme.nmap.org, 192.168.0.1, 10.0.0-255.1-254

SCAN TECHNIQUES:
  -sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans
  -sU: UDP Scan
  -sN/sF/sX: TCP Null, FIN, and Xmas scans
  -sP: Ping Scan - disable port scan
  -sV: Probe open ports to determine service/version info
  -sC: equivalent to --script=default

PORT SPECIFICATION:
  -p <port ranges>: Only scan specified ports
  Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080

SERVICE/VERSION DETECTION:
  -sV: Probe open ports to determine service/version info
  -A: Enable OS detection, version detection, script scanning

OS DETECTION:
  -O: Enable OS detection

OUTPUT:
  -oN/-oX/-oS/-oG <file>: Output scan results
  -v: Increase verbosity level

EXAMPLES:
  nmap -v -A scanme.nmap.org
  nmap -sS -O 192.168.1.0/24
  nmap -sV -p 22,80,443 target.com`);
                    return;
                }

                // Parse arguments
                const hasVersion = args.includes('-sV') || args.includes('-A');
                const hasOS = args.includes('-O') || args.includes('-A');
                const hasAggressive = args.includes('-A');
                const hasVerbose = args.includes('-v') || args.includes('-vv');
                const hasSyn = args.includes('-sS');
                const hasUdp = args.includes('-sU');
                const hasPing = args.includes('-sP') || args.includes('-sn');
                const target = args.find(a => !a.startsWith('-')) || 'scanme.nmap.org';
                
                // Custom port range
                let ports = null;
                const pIndex = args.indexOf('-p');
                if (pIndex !== -1 && args[pIndex + 1]) {
                    ports = args[pIndex + 1];
                }

                // Generate realistic output
                const startTime = new Date().toLocaleString();
                let output = `<span class="info">Starting Nmap ${version} ( https://nmap.org ) at ${startTime}</span>\n`;
                
                if (hasVerbose) {
                    output += `<span class="info">NSE: Loaded 156 scripts for scanning.</span>\n`;
                    output += `<span class="info">Initiating Ping Scan at ${new Date().toLocaleTimeString()}</span>\n`;
                }

                if (hasPing) {
                    output += `Nmap scan report for ${target}\n`;
                    output += `Host is up (0.0${Math.floor(Math.random()*90)+10}s latency).\n`;
                    output += `<span class="success">Nmap done: 1 IP address (1 host up) scanned in 0.${Math.floor(Math.random()*90)+10} seconds</span>`;
                    appendOutput(output);
                    return;
                }

                output += `Nmap scan report for ${target}\n`;
                output += `Host is up (0.0${Math.floor(Math.random()*90)+10}s latency).\n`;
                
                if (hasVerbose) {
                    output += `<span class="info">Scanning ${target} [${ports || '1000'} ports]</span>\n`;
                }

                output += `Not shown: ${980 + Math.floor(Math.random()*15)} closed ports\n\n`;
                output += `<span class="directory">PORT       STATE  SERVICE         VERSION</span>\n`;

                // Common ports with realistic services
                const commonPorts = [
                    { port: '22/tcp', state: 'open', service: 'ssh', version: 'OpenSSH 9.6p1 Debian 4 (protocol 2.0)' },
                    { port: '80/tcp', state: 'open', service: 'http', version: 'nginx 1.24.0' },
                    { port: '443/tcp', state: 'open', service: 'https', version: 'nginx 1.24.0' },
                    { port: '21/tcp', state: 'closed', service: 'ftp', version: '' },
                    { port: '25/tcp', state: 'filtered', service: 'smtp', version: '' },
                    { port: '53/tcp', state: 'open', service: 'domain', version: 'ISC BIND 9.18.24' },
                    { port: '3306/tcp', state: 'open', service: 'mysql', version: 'MySQL 8.0.36' },
                    { port: '5432/tcp', state: 'open', service: 'postgresql', version: 'PostgreSQL DB 16.2' },
                    { port: '6379/tcp', state: 'open', service: 'redis', version: 'Redis 7.2.4' },
                    { port: '8080/tcp', state: 'open', service: 'http-proxy', version: 'Apache Tomcat 10.1' },
                    { port: '27017/tcp', state: 'open', service: 'mongodb', version: 'MongoDB 7.0.5' },
                    { port: '3000/tcp', state: 'open', service: 'http', version: 'Node.js Express' },
                ];

                // Select random subset of ports to show
                const shuffled = commonPorts.sort(() => 0.5 - Math.random());
                const selectedPorts = shuffled.slice(0, 5 + Math.floor(Math.random()*4));
                
                selectedPorts.forEach(p => {
                    const stateColor = p.state === 'open' ? 'success' : p.state === 'filtered' ? 'warning' : 'error';
                    const versionInfo = hasVersion && p.state === 'open' ? p.version : '';
                    output += `${p.port.padEnd(10)} <span class="${stateColor}">${p.state.padEnd(6)}</span> ${p.service.padEnd(15)} ${versionInfo}\n`;
                });

                if (hasOS) {
                    output += `\n<span class="info">OS Detection:</span>\n`;
                    output += `Running: Linux 5.X|6.X\n`;
                    output += `OS CPE: cpe:/o:linux:linux_kernel:6\n`;
                    output += `OS details: Linux 6.1 - 6.7\n`;
                    output += `Network Distance: ${Math.floor(Math.random()*15)+1} hops\n`;
                }

                if (hasAggressive) {
                    output += `\n<span class="info">TRACEROUTE (using port 80/tcp)</span>\n`;
                    output += `HOP  RTT       ADDRESS\n`;
                    output += `1    1.23 ms   gateway (192.168.1.1)\n`;
                    output += `2    5.67 ms   isp-router.net (10.0.0.1)\n`;
                    output += `3    12.34 ms  core-router.isp.net\n`;
                    output += `4    25.89 ms  ${target}\n`;
                }

                const scanTime = (Math.random() * 20 + 5).toFixed(2);
                output += `\n<span class="success">Nmap done: 1 IP address (1 host up) scanned in ${scanTime} seconds</span>`;
                
                appendOutput(output);
            },
            nc: (args) => appendOutput(`<span class="info">netcat</span> ${args.length ? 'Connection established' : 'Usage: nc [options] host port'}`),
            netcat: (args) => packageCommandHandlers.nc(args),
            ip: (args) => appendOutput(`1: lo: <LOOPBACK,UP> mtu 65536\n    inet 127.0.0.1/8\n2: eth0: <BROADCAST,UP> mtu 1500\n    inet 192.168.1.100/24`),
            ss: (args) => appendOutput(`Netid  State   Local Address:Port\ntcp    LISTEN  0.0.0.0:22\ntcp    LISTEN  0.0.0.0:80`),
            dig: (args) => appendOutput(`<span class="info">DiG 9.18</span>\n${args[0] || 'example.com'}.  300  IN  A  93.184.216.34`),
            nslookup: (args) => appendOutput(`Server:  8.8.8.8\nName:    ${args[0] || 'example.com'}\nAddress: 93.184.216.34`),
            host: (args) => appendOutput(`${args[0] || 'example.com'} has address 93.184.216.34`),
            whois: (args) => appendOutput(`<span class="info">WHOIS</span> ${args[0] || 'example.com'}\nRegistrar: Example Registrar\nCreated: 1995-08-14`),
            traceroute: (args) => appendOutput(`traceroute to ${args[0] || 'example.com'}\n 1  gateway (192.168.1.1)  1.234 ms\n 2  isp.net (10.0.0.1)  10.567 ms`),
            mtr: (args) => appendOutput(`<span class="info">mtr</span> ${args[0] || 'example.com'}\nHost          Loss%  Avg\ngateway       0.0%   1.2\nexample.com   0.0%   25.3`),

            // Servers/Databases
            nginx: (args) => {
                if (args[0] === '-v') appendOutput('nginx version: nginx/1.24.0');
                else if (args[0] === '-t') appendOutput(`nginx: configuration <span class="success">ok</span>`);
                else appendOutput(`<span class="info">nginx 1.24.0</span>\n<span class="success">Ready to serve</span>`);
            },
            psql: (args) => appendOutput(`psql (16.2)\npostgres=# `),
            postgres: () => appendOutput(`<span class="info">PostgreSQL 16.2</span>\nServer starting...`),
            pg_dump: (args) => appendOutput(`<span class="success">Dumping database ${args[0] || 'db'}...</span>`),
            mysql: (args) => appendOutput(`mysql> `),
            mysqld: () => appendOutput(`<span class="info">MySQL 8.0.36</span>\nServer starting...`),
            mysqldump: (args) => appendOutput(`<span class="success">Dumping database...</span>`),
            mongod: () => appendOutput(`<span class="info">MongoDB 7.0.5</span>\nWaiting for connections on port 27017`),
            mongo: () => appendOutput(`MongoDB shell\n> `),
            mongosh: () => appendOutput(`mongosh 2.1.4\ntest> `),
            'redis-server': () => appendOutput(`<span class="info">Redis 7.2.4</span>\nReady to accept connections on port 6379`),
            'redis-cli': () => appendOutput(`127.0.0.1:6379> `),

            // Modern CLI tools
            rg: (args) => appendOutput(`<span class="info">ripgrep 14.1.0</span>\n${args[0] ? `Searching for '${args[0]}'...\n<span class="success">README.md</span>:5:Found ${args[0]} here` : 'Usage: rg <pattern>'}`),
            ripgrep: (args) => packageCommandHandlers.rg(args),
            fzf: () => appendOutput(`<span class="info">fzf 0.46.1</span>\n>\n  .bashrc\n  Documents/\n  projects/\n<span class="info">3/3</span>`),
            bat: (args) => {
                if (!args.length) { appendOutput('bat: missing file', 'error'); return; }
                const path = resolvePath(args[0]);
                const node = getNode(path);
                if (!node) { appendOutput(`bat: '${args[0]}': No such file`, 'error'); return; }
                if (node.type === 'dir') { appendOutput(`bat: '${args[0]}': Is a directory`, 'error'); return; }
                appendOutput(`<span class="info">───────┬─────────────────────────────────</span>\n<span class="info">       │ File: ${args[0]}</span>\n<span class="info">───────┼─────────────────────────────────</span>`);
                node.content.split('\n').forEach((line, i) => appendOutput(`<span class="info">${String(i+1).padStart(6)} │</span> ${line}`));
                appendOutput(`<span class="info">───────┴─────────────────────────────────</span>`);
            },
            exa: (args) => {
                const path = resolvePath(args.find(a => !a.startsWith('-')) || '.');
                const node = getNode(path);
                if (!node || node.type !== 'dir') { appendOutput(`exa: No such directory`, 'error'); return; }
                appendOutput(node.children.map(c => `<span class="${getNode(path+'/'+c)?.type === 'dir' ? 'directory' : 'file'}">${c}</span>`).join('  '));
            },
            eza: (args) => packageCommandHandlers.exa(args),
            fd: (args) => appendOutput(`<span class="info">fd 9.0.0</span>\n${args[0] ? `Searching for '${args[0]}'...\nDocuments/notes.txt\nprojects/hello.py` : 'Usage: fd <pattern>'}`),
            tree: (args) => appendOutput(`.\n├── Documents\n│   ├── notes.txt\n│   └── todo.md\n├── projects\n│   ├── hello.py\n│   └── server.js\n└── README.md\n\n3 directories, 5 files`),
            ncdu: () => appendOutput(`<span class="info">ncdu 2.3</span>\n--- /home/arch ---\n  48.5 MiB [##########] /projects\n  12.3 MiB [##        ] /Documents\n   4.2 MiB [          ] /Downloads`),
            duf: () => appendOutput(`<span class="info">duf</span>\n╭───────────┬───────┬───────┬───────┬───────╮\n│ Mounted   │ Size  │ Used  │ Avail │ Use%  │\n├───────────┼───────┼───────┼───────┼───────┤\n│ /         │ 240G  │  48G  │ 192G  │  20%  │\n│ /boot     │ 512M  │ 115M  │ 397M  │  22%  │\n╰───────────┴───────┴───────┴───────┴───────╯`),
            dust: (args) => appendOutput(`<span class="info">dust</span>\n 48M   ┌── projects\n 12M   ├── Documents\n  4M   └── Downloads\n 64M ─┴ .`),
            procs: () => appendOutput(`<span class="info">procs</span>\n PID  User   CPU  MEM  Command\n   1  root   0.0  0.1  systemd\n 567  arch   2.3  0.3  node\n 890  arch   0.7  0.1  vim`),
            jq: (args) => appendOutput(`<span class="info">jq 1.7.1</span>\n${args.length ? '{ "result": "processed" }' : 'Usage: jq <filter> [file]'}`),
            yq: (args) => appendOutput(`<span class="info">yq 4.42.1</span>\n${args.length ? 'result: processed' : 'Usage: yq <expression> [file]'}`),

            // Git tools
            git: (args) => {
                if (!args.length) appendOutput(`<span class="info">git 2.44.0</span>\n\nUsage: git <command>\n\nCommands: clone, init, add, commit, push, pull, status, log`);
                else if (args[0] === 'status') appendOutput(`On branch main\nnothing to commit, working tree clean`);
                else if (args[0] === 'log') appendOutput(`commit a1b2c3d (HEAD -> main)\nAuthor: arch <arch@archlinux>\nDate:   ${new Date().toDateString()}\n\n    Initial commit`);
                else if (args[0] === 'branch') appendOutput(`* main\n  develop`);
                else appendOutput(`<span class="success">git ${args.join(' ')}</span> executed`);
            },
            lazygit: () => appendOutput(`<span class="info">lazygit 0.40.2</span>\n┌─ Status ─────────────────────────────────┐\n│ On branch main                           │\n│ nothing to commit                        │\n└──────────────────────────────────────────┘`),
            lazydocker: () => appendOutput(`<span class="info">lazydocker 0.23.1</span>\n┌─ Containers ─────────────────────────────┐\n│ nginx:latest    Up 2 hours               │\n│ redis:alpine    Up 5 hours               │\n└──────────────────────────────────────────┘`),

            // DevOps tools
            kubectl: (args) => {
                if (!args.length) appendOutput(`<span class="info">kubectl</span>\nUsage: kubectl <command>\n\nCommands: get, apply, delete, describe`);
                else if (args[0] === 'get' && args[1] === 'pods') appendOutput(`NAME                    READY   STATUS    AGE\nnginx-abc123           1/1     Running   2h\nredis-def456           1/1     Running   5h`);
                else appendOutput(`kubectl: ${args.join(' ')} executed`);
            },
            helm: (args) => appendOutput(`<span class="info">Helm 3.14.2</span>\n${args.length ? `${args.join(' ')} executed` : 'Usage: helm <command>'}`),
            terraform: (args) => appendOutput(`<span class="info">Terraform v1.7.4</span>\n${args.length ? `${args.join(' ')} executed` : 'Usage: terraform <command>'}`),
            ansible: (args) => appendOutput(`<span class="info">ansible 9.3.0</span>\n${args.length ? `${args.join(' ')} executed` : 'Usage: ansible <command>'}`),
            'ansible-playbook': (args) => appendOutput(`<span class="success">Running playbook ${args[0] || 'playbook.yml'}...</span>`),
            aws: (args) => appendOutput(`<span class="info">aws-cli 2.15.21</span>\n${args.length ? `${args.join(' ')} executed` : 'Usage: aws <service> <command>'}`),
            gcloud: (args) => appendOutput(`<span class="info">Google Cloud SDK 466.0.0</span>\n${args.length ? `${args.join(' ')} executed` : 'Usage: gcloud <command>'}`),
            az: (args) => appendOutput(`<span class="info">Azure CLI 2.58.0</span>\n${args.length ? `${args.join(' ')} executed` : 'Usage: az <command>'}`),

            // Build tools
            make: (args) => appendOutput(`<span class="info">GNU Make 4.4.1</span>\n${args.length ? `Building ${args[0] || 'all'}...\n<span class="success">Done!</span>` : 'Usage: make [target]'}`),
            cmake: (args) => appendOutput(`<span class="info">cmake 3.28.3</span>\n${args.length ? 'Configuring...\n<span class="success">Done!</span>' : 'Usage: cmake <path>'}`),
            meson: (args) => appendOutput(`<span class="info">meson 1.3.2</span>\n${args.length ? 'Configuring...' : 'Usage: meson <command>'}`),
            ninja: (args) => appendOutput(`<span class="info">ninja 1.11.1</span>\n[1/1] Building...\n<span class="success">Done!</span>`),
            gcc: (args) => appendOutput(`<span class="info">gcc 13.2.1</span>\n${args.length ? `Compiling ${args[args.length-1]}...` : 'Usage: gcc [options] file'}`),
            'g++': (args) => packageCommandHandlers.gcc(args),
            cc: (args) => packageCommandHandlers.gcc(args),
            clang: (args) => appendOutput(`<span class="info">clang 17.0.6</span>\n${args.length ? `Compiling...` : 'Usage: clang [options] file'}`),
            'clang++': (args) => packageCommandHandlers.clang(args),

            // Media tools
            ffmpeg: (args) => appendOutput(`<span class="info">ffmpeg 6.1.1</span>\n${args.length ? 'Processing media...\n<span class="success">Done!</span>' : 'Usage: ffmpeg [options] output'}`),
            ffprobe: (args) => appendOutput(`<span class="info">ffprobe 6.1.1</span>\n${args[0] ? `Duration: 00:03:45\nVideo: h264, 1920x1080\nAudio: aac, 48000 Hz` : 'Usage: ffprobe <file>'}`),
            ffplay: (args) => appendOutput(`<span class="info">ffplay 6.1.1</span>\n${args[0] ? `Playing ${args[0]}...` : 'Usage: ffplay <file>'}`),
            'youtube-dl': (args) => appendOutput(`<span class="info">youtube-dl</span>\n${args[0] ? `Downloading ${args[0]}...\n[download] 100%\n<span class="success">Done!</span>` : 'Usage: youtube-dl <url>'}`),
            'yt-dlp': (args) => appendOutput(`<span class="info">yt-dlp 2024.03.10</span>\n${args[0] ? `Downloading ${args[0]}...\n[download] 100%\n<span class="success">Done!</span>` : 'Usage: yt-dlp <url>'}`),

            // Graphics
            gimp: () => appendOutput(`<span class="info">GIMP 2.10.36</span>\nStarting GIMP...\n<span class="success">GIMP is ready!</span>`),
            blender: () => appendOutput(`<span class="info">Blender 4.0.2</span>\nInitializing...\n<span class="success">Blender started!</span>`),
            inkscape: () => appendOutput(`<span class="info">Inkscape 1.3.2</span>\nStarting...\n<span class="success">Inkscape is ready!</span>`),
            obs: () => appendOutput(`<span class="info">OBS Studio 30.0.2</span>\nStarting OBS...\n<span class="success">Ready to stream/record!</span>`),

            // System info
            neofetch: () => appendOutput(`
<span class="ascii-art">                   -\`                    </span> <span class="prompt-user">arch@archlinux</span>
<span class="ascii-art">                  .o+\`                   </span> ----------------
<span class="ascii-art">                 \`ooo/                   </span> <span class="info">OS:</span> Arch Linux x86_64
<span class="ascii-art">                \`+oooo:                  </span> <span class="info">Host:</span> Browser VM
<span class="ascii-art">               \`+oooooo:                 </span> <span class="info">Kernel:</span> 6.7.0-arch1-1
<span class="ascii-art">               -+oooooo+:                </span> <span class="info">Uptime:</span> ${Math.floor(Math.random()*24)}h ${Math.floor(Math.random()*60)}m
<span class="ascii-art">             \`/:-:++oooo+:               </span> <span class="info">Packages:</span> ${installedPackages.size} (pacman)
<span class="ascii-art">            \`/++++/+++++++:              </span> <span class="info">Shell:</span> bash 5.2
<span class="ascii-art">           \`/++++++++++++++:             </span> <span class="info">Terminal:</span> web-terminal
<span class="ascii-art">          \`/+++ooooooooooooo/\`           </span> <span class="info">CPU:</span> JS V8 @ ${navigator.hardwareConcurrency || 8} cores
<span class="ascii-art">         ./ooosssso++osssssso+\`          </span> <span class="info">Memory:</span> ${Math.floor(Math.random()*4000+2000)}MiB / 16384MiB
<span class="ascii-art">        .oossssso-\`\`\`\`/ossssss+\`         </span>
<span class="ascii-art">       -osssssso.      :ssssssso.        </span>
<span class="ascii-art">      :osssssss/        osssso+++.       </span>
<span class="ascii-art">     /ossssssss/        +ssssooo/-       </span>
<span class="ascii-art">   \`/ossssso+/:-        -:/+osssso+-     </span>
<span class="ascii-art">  \`+sso+:-\`                 \`.-/+oso:    </span>
<span class="ascii-art"> \`++:.                           \`-/+/   </span>
<span class="ascii-art"> .\`                                 \`/   </span>`),
            fastfetch: () => appendOutput(`<span class="info">fastfetch</span>\n<span class="ascii-art">  /\\</span>     <span class="prompt-user">arch@archlinux</span>\n<span class="ascii-art"> /  \\</span>    OS: Arch Linux\n<span class="ascii-art">/    \\</span>   Kernel: 6.7.0\n<span class="ascii-art">\\    /</span>   Shell: bash 5.2\n<span class="ascii-art"> \\  /</span>    Packages: ${installedPackages.size}\n<span class="ascii-art">  \\/</span>     Memory: 4.2G / 16G`),

            // Fun commands
            sl: () => appendOutput(`<span class="warning">      ====        ________                ___________
  _D _|  |_______/        \\__I_I_____===__|_________|
   |(_)---  |   H\\________/ |   |        =|___ ___|  
   /     |  |   H  |  |     |   |         ||_| |_||  
  |      |  |   H  |__--------------------| [___] |  
  | ________|___H__/__|_____/[][]~\\_______|       |  
  |/ |   |-----------I_____I [][] []  D   |=======|__
__/ =| o |=-~~\\  /~~\\  /~~\\  /~~\\ ____Y___________|__
 |/-=|___|=    ||    ||    ||    |_____/~\\___/        
  \\_/      \\O=====O=====O=====O_/      \\_/</span>`),
            cowsay: (args) => {
                const text = args.join(' ') || 'Moo!';
                const border = '-'.repeat(text.length + 2);
                appendOutput(` ${border}\n< ${text} >\n ${border}\n        \\   ^__^\n         \\  (oo)\\_______\n            (__)\\       )\\/\\\n                ||----w |\n                ||     ||`);
            },
            cowthink: (args) => {
                const text = args.join(' ') || 'Hmm...';
                const border = '-'.repeat(text.length + 2);
                appendOutput(` ${border}\n( ${text} )\n ${border}\n        o   ^__^\n         o  (oo)\\_______\n            (__)\\       )\\/\\\n                ||----w |\n                ||     ||`);
            },
            fortune: () => {
                const fortunes = [
                    "BTW, I use Arch.",
                    "The best way to predict the future is to implement it.",
                    "There's no place like 127.0.0.1",
                    "sudo make me a sandwich",
                    "It works on my machine!",
                    "Have you tried turning it off and on again?",
                    "In case of fire: git commit, git push, leave building"
                ];
                appendOutput(fortunes[Math.floor(Math.random() * fortunes.length)]);
            },
            lolcat: (args) => appendOutput(`<span style="color:#ff0000">R</span><span style="color:#ff7f00">a</span><span style="color:#ffff00">i</span><span style="color:#00ff00">n</span><span style="color:#0000ff">b</span><span style="color:#4b0082">o</span><span style="color:#9400d3">w</span> <span style="color:#ff0000">t</span><span style="color:#ff7f00">e</span><span style="color:#ffff00">x</span><span style="color:#00ff00">t</span><span style="color:#0000ff">!</span>`),
            figlet: (args) => appendOutput(`<span class="info"> _____         _   \n|_   _|__  ___| |_ \n  | |/ _ \\/ __| __|\n  | |  __/\\__ \\ |_ \n  |_|\\___||___/\\__|</span>\n(figlet: ${args.join(' ') || 'Test'})`),
            toilet: (args) => appendOutput(`<span class="success">╔╦╗┌─┐┬ ┬┌┬┐\n ║ │ │││ │ │ \n ╩ └─┘┴┴─┘ ┴ </span>\n(toilet: ${args.join(' ') || 'Text'})`),
            cmatrix: () => appendOutput(`<span class="success">Starting Matrix rain...</span>\n<span style="color:#00ff00">01001000 01100101 01101100 01101100 01101111</span>\n<span class="info">(Press Ctrl+C to exit - simulated)</span>`),
            'pipes.sh': () => appendOutput(`<span class="info">Starting pipes...</span>\n┌─┐ ┌──┐\n│ └─┘  │\n└──────┘\n(simulated)`),
            pipes: () => packageCommandHandlers['pipes.sh'](),
            asciiquarium: () => appendOutput(`<span class="info">Starting aquarium...</span>\n<span style="color:#00bfff">~~~~~</span><span style="color:#ffa500">><></span><span style="color:#00bfff">~~~~~</span>\n<span style="color:#00bfff">~~~</span><span style="color:#ff69b4">><></span><span style="color:#00bfff">~~~~~~~</span>\n<span style="color:#228b22">^^^^</span> <span style="color:#8b4513">🏰</span> <span style="color:#228b22">^^^^</span>`),
            hollywood: () => appendOutput(`<span class="success">ACCESSING MAINFRAME...</span>\n<span class="warning">[################] 100%</span>\n<span class="info">HACK COMPLETE</span>\n(hollywood simulation)`),

            // SSH key generation
            'ssh-keygen': (args) => appendOutput(`Generating public/private rsa key pair.\nYour identification has been saved in /home/arch/.ssh/id_rsa\nYour public key has been saved in /home/arch/.ssh/id_rsa.pub\n<span class="success">Key generated!</span>`),

            // ==================== KALI LINUX SECURITY TOOLS ====================

            // Information Gathering
            maltego: () => appendOutput(`<span class="info">Maltego 4.6.0</span>\nStarting Maltego Community Edition...\n<span class="success">Maltego GUI launched!</span>\n\nTransforms loaded: 156\nEntities available: 48`),
            
            'recon-ng': (args) => {
                if (!args.length) appendOutput(`<span class="info">[recon-ng][default] ></span>\n\n<span class="success">recon-ng 5.1.2</span>\n\nModules: 85 loaded\nWorkspaces: 1\n\nCommands:\n  marketplace    Manage modules\n  modules        Interact with modules\n  workspaces     Manage workspaces\n  db             Database operations\n  show           Show various info`);
                else appendOutput(`<span class="success">[*]</span> ${args.join(' ')} executed`);
            },

            theHarvester: (args) => {
                const domain = args.find(a => !a.startsWith('-')) || 'example.com';
                appendOutput(`<span class="info">*******************************************************************
*  _   _                                            _             *
* | |_| |__   ___    /\\  /\\__ _ _ ____   _____  ___| |_ ___ _ __  *
* | __| '_ \\ / _ \\  / /_/ / _\` | '__\\ \\ / / _ \\/ __| __/ _ \\ '__| *
* | |_| | | |  __/ / __  / (_| | |   \\ V /  __/\\__ \\ ||  __/ |    *
*  \\__|_| |_|\\___| \\/ /_/ \\__,_|_|    \\_/ \\___||___/\\__\\___|_|    *
*                                                                 *
* theHarvester 4.4.0                                              *
*******************************************************************</span>

<span class="success">[*]</span> Target: ${domain}
<span class="success">[*]</span> Searching Google...
<span class="success">[*]</span> Searching Bing...
<span class="success">[*]</span> Searching LinkedIn...

<span class="info">[+] Emails found:</span>
  admin@${domain}
  info@${domain}
  support@${domain}

<span class="info">[+] Hosts found:</span>
  www.${domain}
  mail.${domain}
  api.${domain}
  dev.${domain}

<span class="success">[*]</span> OSINT gathering complete!`);
            },
            theharvester: (args) => packageCommandHandlers.theHarvester(args),

            shodan: (args) => {
                if (!args.length) appendOutput(`<span class="info">Shodan CLI 1.31.0</span>\n\nUsage: shodan <command>\n\nCommands:\n  init       Initialize the Shodan CLI\n  search     Search the Shodan database\n  host       View host information\n  scan       Scan an IP/network\n  stats      Search statistics\n  download   Download search results`);
                else if (args[0] === 'search') appendOutput(`<span class="success">Results found: ${Math.floor(Math.random()*10000)}</span>\n\n192.168.1.1\n  Port: 22, 80, 443\n  Org: Example ISP\n  Country: United States\n\n10.0.0.1\n  Port: 22, 8080\n  Org: Cloud Provider\n  Country: Germany`);
                else if (args[0] === 'host') appendOutput(`<span class="info">IP: ${args[1] || '192.168.1.1'}</span>\nHostnames: example.com\nOrg: Example Corp\nCountry: United States\nOpen Ports: 22, 80, 443, 3306`);
                else appendOutput(`<span class="success">shodan ${args.join(' ')}</span> executed`);
            },

            spiderfoot: (args) => appendOutput(`<span class="info">SpiderFoot 4.0.0</span>\n${args.includes('-l') ? 'Starting web interface on http://127.0.0.1:5001' : 'Usage: spiderfoot -l 127.0.0.1:5001 -s <target>'}\n<span class="success">SpiderFoot ready for OSINT gathering!</span>`),
            sf: (args) => packageCommandHandlers.spiderfoot(args),

            dmitry: (args) => {
                const target = args.find(a => !a.startsWith('-')) || 'example.com';
                appendOutput(`<span class="info">Deepmagic Information Gathering Tool</span>
<span class="success">HostIP: 93.184.216.34</span>
<span class="success">HostName: ${target}</span>

<span class="info">Gathered TCP Port information for ${target}</span>
 Port: 22/tcp    open
 Port: 80/tcp    open
 Port: 443/tcp   open`);
            },

            fierce: (args) => {
                const domain = args.find(a => !a.startsWith('-')) || 'example.com';
                appendOutput(`<span class="info">Fierce 1.5.0</span>
<span class="success">[+]</span> DNS Servers for ${domain}:
    ns1.${domain}
    ns2.${domain}

<span class="success">[+]</span> Zone Transfer: FAILED
<span class="success">[+]</span> Bruteforcing subdomains...
    www.${domain} - 93.184.216.34
    mail.${domain} - 93.184.216.35
    api.${domain} - 93.184.216.36
    dev.${domain} - 93.184.216.37`);
            },

            amass: (args) => {
                if (!args.length) appendOutput(`<span class="info">Amass 4.2.0</span>\n\nUsage: amass <subcommand>\n\nSubcommands:\n  enum     Perform enumerations\n  intel    Discover targets\n  viz      Visualize results\n  track    Track changes\n  db       Database operations`);
                else {
                    const domain = args.find(a => !a.startsWith('-')) || 'example.com';
                    appendOutput(`<span class="info">Amass v4.2.0</span>
<span class="success">[+]</span> Querying data sources...
<span class="success">[+]</span> ${domain}
    www.${domain}
    api.${domain}
    mail.${domain}
    dev.${domain}
    staging.${domain}
    admin.${domain}
    blog.${domain}
    cdn.${domain}

<span class="info">[+]</span> ${8} subdomains discovered`);
                }
            },

            subfinder: (args) => {
                const domain = args.find(a => !a.startsWith('-')) || 'example.com';
                appendOutput(`<span class="info">subfinder 2.6.5</span>

<span class="success">[INF]</span> Enumerating subdomains for ${domain}
www.${domain}
api.${domain}
mail.${domain}
admin.${domain}
dev.${domain}
staging.${domain}

<span class="success">[INF]</span> Found 6 subdomains for ${domain} in 2.5s`);
            },

            masscan: (args) => {
                if (!args.length) appendOutput(`<span class="info">Masscan 1.3.2</span>\nUsage: masscan [Options] -p{ports} {target}`);
                else {
                    const target = args.find(a => !a.startsWith('-') && !a.startsWith('p')) || '192.168.1.0/24';
                    appendOutput(`<span class="info">Starting masscan 1.3.2</span>
Initiating SYN Stealth Scan
Scanning ${target}
rate: 10000.00-kpps

<span class="success">Discovered open port 22/tcp on 192.168.1.1</span>
<span class="success">Discovered open port 80/tcp on 192.168.1.1</span>
<span class="success">Discovered open port 443/tcp on 192.168.1.1</span>
<span class="success">Discovered open port 22/tcp on 192.168.1.50</span>
<span class="success">Discovered open port 3389/tcp on 192.168.1.100</span>`);
                }
            },

            enum4linux: (args) => {
                const target = args.find(a => !a.startsWith('-')) || '192.168.1.1';
                appendOutput(`<span class="info">enum4linux 0.9.1</span>
<span class="info">========================</span>
|    Target: ${target}    |
<span class="info">========================</span>

<span class="success">[+]</span> Server ${target} allows sessions using username '', password ''
<span class="success">[+]</span> Got domain/workgroup name: WORKGROUP
<span class="success">[+]</span> Getting domain SID for ${target}

<span class="info">[+] Users:</span>
  Administrator
  Guest
  DefaultAccount

<span class="info">[+] Shares:</span>
  IPC$ - Remote IPC
  ADMIN$ - Remote Admin
  C$ - Default share`);
            },

            dnsrecon: (args) => {
                const domain = args.find(a => !a.startsWith('-')) || 'example.com';
                appendOutput(`<span class="info">[*] Performing DNS enumeration for ${domain}</span>
<span class="success">[+] SOA:</span> ns1.${domain} 
<span class="success">[+] NS:</span> ns1.${domain}, ns2.${domain}
<span class="success">[+] MX:</span> mail.${domain} (10)
<span class="success">[+] A:</span> ${domain} -> 93.184.216.34
<span class="success">[+] TXT:</span> "v=spf1 include:_spf.google.com ~all"`);
            },

            whatweb: (args) => {
                const target = args[0] || 'https://example.com';
                appendOutput(`<span class="info">WhatWeb 0.5.5</span>
${target} [200 OK]
  Country: UNITED STATES
  HTTPServer: nginx/1.24.0
  IP: 93.184.216.34
  Title: Example Domain
  X-Powered-By: PHP/8.3.0
  Cookies: session_id
  Meta-Author: Example Corp
  <span class="success">WordPress[6.4.3]</span>`);
            },

            wafw00f: (args) => {
                const target = args[0] || 'https://example.com';
                appendOutput(`<span class="info">WAFW00F 2.2.0</span>
Checking ${target}

<span class="success">[+]</span> The site ${target} is behind <span class="warning">Cloudflare (Cloudflare Inc.)</span> WAF.

Number of requests: 6`);
            },

            // Vulnerability Analysis
            nikto: (args) => {
                const target = args.find(a => !a.startsWith('-')) || 'http://example.com';
                appendOutput(`<span class="info">- Nikto v2.5.0</span>
---------------------------------------------------------------------------
+ Target IP:          93.184.216.34
+ Target Hostname:    ${target.replace('http://', '').replace('https://', '')}
+ Target Port:        80
+ Start Time:         ${new Date().toLocaleString()}
---------------------------------------------------------------------------
+ Server: nginx/1.24.0
<span class="success">+ /: The anti-clickjacking X-Frame-Options header is not present.</span>
<span class="success">+ /: Uncommon header 'x-powered-by' found, with contents: PHP/8.3.0</span>
<span class="warning">+ /admin/: Admin directory found</span>
<span class="warning">+ /backup/: Backup directory found</span>
<span class="warning">+ /phpinfo.php: PHP info file found</span>
<span class="error">+ OSVDB-3092: /admin/: This might be interesting...</span>
+ ${Math.floor(Math.random()*20+5)} items checked
+ End Time: ${new Date().toLocaleString()}`);
            },

            openvas: () => appendOutput(`<span class="info">OpenVAS 22.7.0</span>\nStarting Greenbone Vulnerability Manager...\n<span class="success">GVM services started!</span>\nWeb interface: https://127.0.0.1:9392`),
            'gvm-start': () => packageCommandHandlers.openvas(),
            'gvm-stop': () => appendOutput(`<span class="warning">Stopping GVM services...</span>\n<span class="success">GVM stopped.</span>`),

            nessus: () => appendOutput(`<span class="info">Nessus 10.7.0</span>\nStarting Nessus...\n<span class="success">Nessus is running!</span>\nWeb interface: https://localhost:8834`),
            nessusd: () => packageCommandHandlers.nessus(),

            wpscan: (args) => {
                const target = args.find(a => !a.startsWith('-')) || 'http://example.com';
                appendOutput(`<span class="info">_______________________________________________________________
         __          _______   _____
         \\ \\        / /  __ \\ / ____|
          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ ®
           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _\` | '_ \\
            \\  /\\  /  | |     ____) | (__| (_| | | | |
             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|

         WordPress Security Scanner v3.8.25</span>

<span class="success">[+]</span> URL: ${target}/
<span class="success">[+]</span> WordPress version: 6.4.3
<span class="warning">[!]</span> 2 vulnerabilities identified

<span class="info">[i]</span> Plugins:
<span class="success">[+]</span> contact-form-7 (5.8.6)
<span class="warning">[!]</span> akismet (5.3) - 1 vulnerability

<span class="info">[i]</span> Theme: twentytwentyfour (1.0)
<span class="success">[+]</span> No vulnerabilities found`);
            },

            sqlmap: (args) => {
                if (!args.length) appendOutput(`<span class="info">sqlmap 1.8.2</span>\nUsage: sqlmap -u <URL> [options]\n\nOptions:\n  -u URL         Target URL\n  --dbs          Enumerate databases\n  --tables       Enumerate tables\n  --dump         Dump table entries\n  --batch        Never ask for user input`);
                else {
                    const target = args.find(a => !a.startsWith('-')) || 'http://example.com/page?id=1';
                    appendOutput(`<span class="info">        ___
       __H__
 ___ ___[']_____ ___ ___  {1.8.2}
|_ -| . [.]     | .'| . |
|___|_  [']_|_|_|__,|  _|
      |_|V...       |_|   sqlmap</span>

<span class="success">[*]</span> starting at ${new Date().toLocaleTimeString()}
<span class="success">[*]</span> testing URL: ${target}
<span class="warning">[*]</span> testing 'AND boolean-based blind'
<span class="success">[+]</span> <span class="error">Parameter 'id' is vulnerable!</span>
<span class="success">[+]</span> Type: boolean-based blind
<span class="success">[+]</span> Type: time-based blind
<span class="success">[+]</span> Type: UNION query

<span class="info">[*]</span> Database: mysql
<span class="info">[*]</span> Tables: users, products, orders`);
                }
            },

            lynis: (args) => appendOutput(`<span class="info">Lynis 3.1.1</span>
<span class="success">[+]</span> Initializing program
<span class="success">[+]</span> Detecting OS...       Linux
<span class="success">[+]</span> Checking profiles...
<span class="success">[+]</span> Running tests...

<span class="info">[ Kernel ]</span>
<span class="success">[+]</span> Kernel version: 6.7.0

<span class="info">[ Security ]</span>
<span class="warning">[!]</span> Consider hardening SSH configuration
<span class="warning">[!]</span> Enable firewall

<span class="info">Hardening index: 72/100</span>`),

            nuclei: (args) => {
                if (!args.length) appendOutput(`<span class="info">Nuclei 3.2.0</span>\nUsage: nuclei -u <target> [options]\n\nOptions:\n  -u           Target URL\n  -l           List of targets\n  -t           Templates to run\n  -severity    Filter by severity`);
                else {
                    const target = args.find(a => !a.startsWith('-')) || 'https://example.com';
                    appendOutput(`<span class="info">                     __     _
   ____  __  _______/ /__  (_)
  / __ \\/ / / / ___/ / _ \\/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\\__,_/\\___/_/\\___/_/   v3.2.0</span>

<span class="success">[INF]</span> Templates loaded: 6547
<span class="success">[INF]</span> Targets loaded: 1

<span class="warning">[CVE-2024-1234]</span> [medium] ${target}
<span class="warning">[exposed-panels]</span> [info] ${target}/admin
<span class="success">[tech-detect:nginx]</span> [info] ${target}
<span class="success">[http-missing-security-headers]</span> [info] ${target}`);
                }
            },

            trivy: (args) => {
                const target = args.find(a => !a.startsWith('-')) || 'nginx:latest';
                appendOutput(`<span class="info">Trivy 0.49.0</span>

${target} (debian 12.4)
Total: 42 (UNKNOWN: 0, LOW: 25, MEDIUM: 12, HIGH: 4, CRITICAL: 1)

┌─────────────┬──────────────┬──────────┬───────────────────┐
│   Library   │ Vulnerability│ Severity │ Installed Version │
├─────────────┼──────────────┼──────────┼───────────────────┤
│ openssl     │ CVE-2024-001 │ CRITICAL │ 3.0.11            │
│ curl        │ CVE-2024-002 │ HIGH     │ 8.4.0             │
│ zlib        │ CVE-2024-003 │ MEDIUM   │ 1.2.13            │
└─────────────┴──────────────┴──────────┴───────────────────┘`);
            },

            grype: (args) => packageCommandHandlers.trivy(args),

            // Web Application Analysis
            burpsuite: () => appendOutput(`<span class="info">Burp Suite Professional v2024.2.1</span>\nStarting Burp Suite...\n<span class="success">Burp Suite launched!</span>\n\nProxy: 127.0.0.1:8080\nModules: Proxy, Spider, Scanner, Intruder, Repeater, Decoder`),
            burp: () => packageCommandHandlers.burpsuite(),

            zaproxy: () => appendOutput(`<span class="info">OWASP ZAP 2.14.0</span>\nStarting ZAP...\n<span class="success">ZAP is running!</span>\n\nProxy: 127.0.0.1:8080\nAPI: http://127.0.0.1:8080/`),
            zap: () => packageCommandHandlers.zaproxy(),
            'owasp-zap': () => packageCommandHandlers.zaproxy(),

            gobuster: (args) => {
                if (!args.length) appendOutput(`<span class="info">Gobuster 3.6.0</span>\n\nUsage: gobuster [command]\n\nCommands:\n  dir      Directory/file enumeration\n  dns      DNS subdomain enumeration\n  vhost    Virtual host enumeration\n  fuzz     Fuzzing mode`);
                else {
                    const target = args.find(a => !a.startsWith('-')) || 'http://example.com';
                    appendOutput(`<span class="info">Gobuster v3.6.0</span>
===============================================================
<span class="success">[+]</span> Url:           ${target}
<span class="success">[+]</span> Wordlist:      /usr/share/wordlists/dirb/common.txt
<span class="success">[+]</span> Threads:       10
===============================================================
<span class="success">/admin</span>               (Status: 200) [Size: 1234]
<span class="success">/api</span>                 (Status: 200) [Size: 567]
<span class="success">/backup</span>              (Status: 403) [Size: 289]
<span class="success">/css</span>                 (Status: 301) [Size: 178]
<span class="success">/images</span>              (Status: 301) [Size: 178]
<span class="success">/js</span>                  (Status: 301) [Size: 178]
<span class="success">/login</span>               (Status: 200) [Size: 2341]
<span class="warning">/robots.txt</span>          (Status: 200) [Size: 123]
===============================================================`);
                }
            },

            dirb: (args) => {
                const target = args[0] || 'http://example.com';
                appendOutput(`<span class="info">DIRB v2.22</span>
By The Dark Raver

START_TIME: ${new Date().toLocaleString()}
URL_BASE: ${target}/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------
<span class="success">+ ${target}/admin (CODE:200|SIZE:1234)</span>
<span class="success">+ ${target}/backup (CODE:403|SIZE:289)</span>
<span class="success">+ ${target}/images (CODE:301|SIZE:178)</span>
<span class="success">+ ${target}/index.html (CODE:200|SIZE:5678)</span>

-----------------
END_TIME: ${new Date().toLocaleString()}
DOWNLOADED: 4612 - FOUND: 4`);
            },

            dirbuster: () => appendOutput(`<span class="info">DirBuster 1.0</span>\nStarting DirBuster GUI...\n<span class="success">DirBuster launched!</span>`),

            wfuzz: (args) => {
                if (!args.length) appendOutput(`<span class="info">Wfuzz 3.1.0</span>\nUsage: wfuzz -w <wordlist> -u <url> FUZZ`);
                else appendOutput(`<span class="info">********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: ${args.find(a => !a.startsWith('-')) || 'http://example.com/FUZZ'}
Payload: /usr/share/wordlists/common.txt

<span class="success">000001:   C=200    234 L      567 W    admin</span>
<span class="success">000015:   C=200    123 L      234 W    api</span>
<span class="success">000023:   C=301      0 L        0 W    images</span>
<span class="warning">000045:   C=403     12 L       34 W    backup</span>

Total requests: 4614`);
            },

            ffuf: (args) => {
                if (!args.length) appendOutput(`<span class="info">ffuf 2.1.0</span>\nUsage: ffuf -w <wordlist> -u <url>/FUZZ`);
                else appendOutput(`<span class="info">        /'___\\  /'___\\           /'___\\       
       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       
       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      
        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      
         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       
          \\/_/    \\/_/   \\/___/    \\/_/       

       v2.1.0</span>

<span class="success">[Status: 200, Size: 1234, Words: 123, Lines: 45] admin</span>
<span class="success">[Status: 200, Size: 567, Words: 56, Lines: 12] api</span>
<span class="success">[Status: 301, Size: 178, Words: 6, Lines: 8] images</span>
<span class="warning">[Status: 403, Size: 289, Words: 10, Lines: 7] backup</span>

:: Progress: [4614/4614] :: Job [1/1] :: 125 req/sec`);
            },

            feroxbuster: (args) => packageCommandHandlers.gobuster(args),
            httpx: (args) => appendOutput(`<span class="info">httpx 1.3.9</span>\n${args[0] || 'example.com'} [200] [nginx] [Example Domain] [text/html]`),
            katana: (args) => appendOutput(`<span class="info">Katana 1.0.5</span>\nCrawling ${args[0] || 'https://example.com'}...\n\nhttps://example.com/\nhttps://example.com/about\nhttps://example.com/contact\nhttps://example.com/api/v1`),
            arjun: (args) => appendOutput(`<span class="info">Arjun 2.2.1</span>\n${args[0] ? `Scanning ${args[0]}...\n\nFound parameters:\n  id, name, page, search, q` : 'Usage: arjun -u <url>'}`),
            paramspider: (args) => appendOutput(`<span class="info">ParamSpider 1.0</span>\n${args[0] ? `Mining ${args[0]}...\n\nParameters found:\n  ?id=\n  ?page=\n  ?search=` : 'Usage: paramspider -d <domain>'}`),

            // Password Attacks
            john: (args) => {
                if (!args.length) appendOutput(`<span class="info">John the Ripper 1.9.0</span>\nUsage: john [options] <password-file>\n\nOptions:\n  --wordlist=FILE    Wordlist mode\n  --format=FORMAT    Hash format\n  --show             Show cracked passwords`);
                else appendOutput(`<span class="info">John the Ripper 1.9.0</span>
Using default input encoding: UTF-8
Loaded ${Math.floor(Math.random()*10+1)} password hash(es)
Press 'q' or Ctrl-C to abort

<span class="success">password123</span>      (user1)
<span class="success">admin2024</span>        (admin)
<span class="success">letmein</span>          (user2)

Session completed`);
            },
            'john-the-ripper': (args) => packageCommandHandlers.john(args),

            hashcat: (args) => {
                if (!args.length) appendOutput(`<span class="info">hashcat 6.2.6</span>\n\nUsage: hashcat [options] hash [wordlist]\n\nHash modes:\n  0      MD5\n  100    SHA1\n  1000   NTLM\n  1800   sha512crypt\n  3200   bcrypt`);
                else appendOutput(`<span class="info">hashcat 6.2.6</span>
Session: hashcat
Status: Running
Hash.Type: MD5
Speed.#1: 15234.5 MH/s

<span class="success">5f4dcc3b5aa765d61d8327deb882cf99:password</span>
<span class="success">e99a18c428cb38d5f260853678922e03:abc123</span>

Status: Cracked`);
            },

            hydra: (args) => {
                if (!args.length) appendOutput(`<span class="info">Hydra 9.5</span>\n\nUsage: hydra [options] target service\n\nOptions:\n  -l LOGIN    Single username\n  -L FILE     Username list\n  -p PASS     Single password\n  -P FILE     Password list\n\nServices: ssh, ftp, http-get, http-post, mysql, smb, rdp`);
                else {
                    const target = args.find(a => !a.startsWith('-')) || '192.168.1.1';
                    appendOutput(`<span class="info">Hydra v9.5</span>

[DATA] max 16 tasks per 1 server
[DATA] attacking ${target}

<span class="success">[22][ssh] host: ${target}   login: admin   password: password123</span>
<span class="success">[22][ssh] host: ${target}   login: root    password: toor</span>

[STATUS] attack finished for ${target} (found 2 valid pairs)`);
                }
            },
            xhydra: () => appendOutput(`<span class="info">xHydra</span>\nStarting Hydra GUI...\n<span class="success">xHydra launched!</span>`),

            medusa: (args) => appendOutput(`<span class="info">Medusa 2.2</span>\n${args.length ? `Attacking target...\n<span class="success">ACCOUNT FOUND: [ssh] Host: 192.168.1.1 User: admin Password: admin123</span>` : 'Usage: medusa -h <host> -u <user> -P <passlist> -M <module>'}`),

            cewl: (args) => appendOutput(`<span class="info">CeWL 6.1</span>\n${args[0] ? `Crawling ${args[0]}...\n\nWords found: ${Math.floor(Math.random()*500+100)}\nSaved to: wordlist.txt` : 'Usage: cewl <url>'}`),

            crunch: (args) => appendOutput(`<span class="info">Crunch 3.6</span>\n${args.length ? `Generating wordlist...\n<span class="success">Wordlist saved!</span>` : 'Usage: crunch <min> <max> [charset]'}`),

            ophcrack: () => appendOutput(`<span class="info">Ophcrack 3.8.0</span>\nStarting Ophcrack...\n<span class="success">Ophcrack GUI launched!</span>\nLoad SAM hashes to begin cracking.`),

            'hash-identifier': (args) => appendOutput(`<span class="info">Hash Identifier 1.2</span>\n${args[0] ? `\nAnalyzing: ${args[0]}\n\nPossible hash types:\n  [+] MD5\n  [+] MD4\n  [+] Domain Cached Credentials` : 'Usage: hash-identifier <hash>'}`),
            hashid: (args) => packageCommandHandlers['hash-identifier'](args),

            patator: (args) => appendOutput(`<span class="info">Patator 0.9</span>\n${args.length ? 'Starting brute force...\n<span class="success">Found credentials!</span>' : 'Usage: patator <module> <options>'}`),
            crowbar: (args) => appendOutput(`<span class="info">Crowbar 4.2</span>\n${args.length ? 'Brute forcing...\n<span class="success">Success!</span>' : 'Usage: crowbar -b <service> -s <target> -u <user> -C <passlist>'}`),
            ncrack: (args) => appendOutput(`<span class="info">Ncrack 0.7</span>\n${args.length ? 'Cracking...\n<span class="success">Discovered credentials!</span>' : 'Usage: ncrack <target>'}`),

            // Wireless Attacks
            'aircrack-ng': (args) => appendOutput(`<span class="info">Aircrack-ng 1.7</span>\n${args[0] ? `Reading packets from ${args[0]}...\n\n<span class="success">KEY FOUND! [ password123 ]</span>` : 'Usage: aircrack-ng [options] <capture file>'}`),
            'airodump-ng': (args) => appendOutput(`<span class="info">Airodump-ng 1.7</span>
${args[0] ? `
 CH  9 ][ Elapsed: 30 s

 BSSID              PWR  Beacons  #Data  CH   ENC   ESSID
 
 00:11:22:33:44:55  -45      125     50   9   WPA2  MyNetwork
 AA:BB:CC:DD:EE:FF  -67       89     12   6   WPA2  Neighbor
 
 BSSID              STATION            PWR  Packets
 
 00:11:22:33:44:55  66:77:88:99:AA:BB  -35      234` : 'Usage: airodump-ng <interface>'}`),
            'aireplay-ng': (args) => appendOutput(`<span class="info">Aireplay-ng 1.7</span>\n${args.length ? 'Sending packets...\n<span class="success">Injection successful!</span>' : 'Usage: aireplay-ng [options] <interface>'}`),
            'airmon-ng': (args) => appendOutput(`<span class="info">Airmon-ng 1.7</span>\n\nPHY     Interface   Driver      Chipset\n\nphy0    wlan0       ath9k       Qualcomm Atheros\n${args.includes('start') ? '\n<span class="success">monitor mode enabled on wlan0mon</span>' : ''}`),
            'airdecap-ng': (args) => appendOutput(`<span class="info">Airdecap-ng 1.7</span>\n${args.length ? 'Decrypting packets...\n<span class="success">Done!</span>' : 'Usage: airdecap-ng [options] <pcap file>'}`),

            kismet: () => appendOutput(`<span class="info">Kismet 2023.07</span>\nStarting Kismet server...\n<span class="success">Kismet running!</span>\nWeb UI: http://localhost:2501`),
            kismet_server: () => packageCommandHandlers.kismet(),

            wifite: (args) => appendOutput(`<span class="info">Wifite 2.7.0</span>

   .               .    
  ,|               |,   
 //|   WIFITE2     |\\\\  
|||  Automated      ||| 
|||  Wireless       ||| 
|||  Auditor        ||| 
 \\\\|               |//  
  \`|               |\`   

<span class="success">[+]</span> Scanning for targets...
<span class="success">[+]</span> Found 5 access points

   # ESSID              CH  ENCR  POWER  WPS  CLIENT
   1 MyNetwork           9  WPA2  -45dB  Yes  1
   2 Neighbor            6  WPA2  -67dB  No   0`),
            wifite2: (args) => packageCommandHandlers.wifite(args),

            reaver: (args) => appendOutput(`<span class="info">Reaver 1.6.6</span>\n${args.length ? `\nTargeting BSSID...\n[+] Trying pin: 12345670\n[+] Trying pin: 12345671\n<span class="success">[+] WPS PIN: 12345678</span>\n<span class="success">[+] WPA PSK: password123</span>` : 'Usage: reaver -i <interface> -b <bssid>'}`),
            bully: (args) => appendOutput(`<span class="info">Bully 1.4.0</span>\n${args.length ? 'WPS attack running...\n<span class="success">PIN found!</span>' : 'Usage: bully <interface> -b <bssid>'}`),
            'fern-wifi-cracker': () => appendOutput(`<span class="info">Fern Wifi Cracker 3.3</span>\nStarting GUI...\n<span class="success">Fern launched!</span>`),
            cowpatty: (args) => appendOutput(`<span class="info">coWPAtty 4.8</span>\n${args.length ? 'Dictionary attack...\n<span class="success">The PSK is "password123"</span>' : 'Usage: cowpatty -f <wordlist> -r <capture> -s <ssid>'}`),
            pixiewps: (args) => appendOutput(`<span class="info">Pixiewps 1.4.2</span>\n${args.length ? '<span class="success">[+] WPS pin: 12345678</span>' : 'Usage: pixiewps -e <pke> -r <pkr> -s <e-hash1> -z <e-hash2>'}`),
            'hostapd-wpe': () => appendOutput(`<span class="info">hostapd-wpe 2.10</span>\nStarting rogue AP...\n<span class="success">AP running! Waiting for clients...</span>`),
            fluxion: () => appendOutput(`<span class="info">Fluxion 6.0</span>\n<span class="success">Starting Fluxion...</span>\nSelect attack vector:\n1) Captive Portal\n2) Handshake Snooper\n3) PMKID Attack`),

            // Exploitation Tools
            msfconsole: () => appendOutput(`<span class="info">
                                                  
     ,           ,
    /             \\
   ((__---,,,---__))
      (_) O O (_)_________
         \\ _ /            |\\
          o_o \\   M S F   | \\
               \\   6.4    |  \\
                \\         |___\\
                 |        |
                 |________|

       =[ metasploit v6.4.0-dev ]
+ -- --=[ 2380 exploits - 1236 auxiliary - 416 post ]
+ -- --=[ 1388 payloads - 46 encoders - 11 nops ]
+ -- --=[ 9 evasion ]

msf6 ></span>`),

            msfvenom: (args) => {
                if (!args.length) appendOutput(`<span class="info">msfvenom</span>\nUsage: msfvenom -p <payload> [options]\n\nPayloads:\n  windows/meterpreter/reverse_tcp\n  linux/x64/shell_reverse_tcp\n  php/reverse_php`);
                else appendOutput(`<span class="info">msfvenom</span>\n[-] Generating payload...\n<span class="success">[+] Payload generated: payload.exe</span>\nPayload size: ${Math.floor(Math.random()*1000+500)} bytes`);
            },

            msfdb: (args) => appendOutput(`<span class="info">msfdb</span>\n${args[0] === 'init' ? '<span class="success">Database initialized!</span>' : args[0] === 'start' ? '<span class="success">Database started!</span>' : 'Usage: msfdb init|start|stop|status'}`),
            msfrpcd: () => appendOutput(`<span class="info">msfrpcd</span>\n<span class="success">RPC daemon started on 127.0.0.1:55553</span>`),
            msfupdate: () => appendOutput(`<span class="info">msfupdate</span>\nUpdating Metasploit Framework...\n<span class="success">Already up to date!</span>`),

            'beef-xss': () => appendOutput(`<span class="info">BeEF 0.5.4</span>
<span class="success">[*]</span> Browser Exploitation Framework
<span class="success">[+]</span> Running on http://127.0.0.1:3000/ui/panel
<span class="success">[+]</span> Hook URL: http://127.0.0.1:3000/hook.js`),
            beef: () => packageCommandHandlers['beef-xss'](),

            searchsploit: (args) => {
                if (!args.length) appendOutput(`<span class="info">SearchSploit</span>\nUsage: searchsploit <term>`);
                else appendOutput(`<span class="info">SearchSploit - Exploit Database</span>
-----------------------------------------
 Exploit Title                         |  Path
-----------------------------------------
${args[0]} 1.0 - Remote Code Execution | exploits/php/webapps/12345.py
${args[0]} 2.0 - SQL Injection         | exploits/php/webapps/12346.txt
${args[0]} - Arbitrary File Upload     | exploits/php/webapps/12347.rb
-----------------------------------------`);
            },

            setoolkit: () => appendOutput(`<span class="info">Social-Engineer Toolkit (SET) 8.0.3</span>

Select from the menu:
  1) Social-Engineering Attacks
  2) Penetration Testing
  3) Third Party Modules
  4) Update the SET
  5) Exit

set>`),
            'se-toolkit': () => packageCommandHandlers.setoolkit(),

            armitage: () => appendOutput(`<span class="info">Armitage 1.5</span>\nStarting Armitage...\n<span class="success">Connected to Metasploit!</span>`),

            crackmapexec: (args) => {
                if (!args.length) appendOutput(`<span class="info">CrackMapExec 5.4.0</span>\nUsage: crackmapexec <protocol> <target> [options]\n\nProtocols: smb, ssh, winrm, ldap, mssql`);
                else appendOutput(`<span class="info">CME</span>
SMB   192.168.1.1  445  DC01  [*] Windows Server 2019 Build 17763
SMB   192.168.1.1  445  DC01  <span class="success">[+] DOMAIN\\admin:password (Pwn3d!)</span>`);
            },
            cme: (args) => packageCommandHandlers.crackmapexec(args),

            'evil-winrm': (args) => appendOutput(`<span class="info">Evil-WinRM 3.5</span>\n${args.length ? '<span class="success">*Evil-WinRM* PS C:\\Users\\admin> </span>' : 'Usage: evil-winrm -i <ip> -u <user> -p <pass>'}`),

            'impacket-smbserver': (args) => appendOutput(`<span class="info">Impacket SMB Server</span>\n<span class="success">[*] Starting SMB server on 0.0.0.0:445</span>`),
            'impacket-wmiexec': (args) => appendOutput(`<span class="info">Impacket wmiexec</span>\n${args.length ? '<span class="success">[*] SMBv3 connection established</span>\nC:\\>' : 'Usage: wmiexec.py domain/user:pass@target'}`),
            'impacket-psexec': (args) => packageCommandHandlers['impacket-wmiexec'](args),
            'impacket-secretsdump': (args) => appendOutput(`<span class="info">Impacket secretsdump</span>\n${args.length ? '<span class="success">[*] Dumping secrets...</span>\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::' : 'Usage: secretsdump.py domain/user:pass@target'}`),
            'impacket-ntlmrelayx': () => appendOutput(`<span class="info">Impacket ntlmrelayx</span>\n<span class="success">[*] Starting relay server</span>\n[*] Waiting for connections...`),

            covenant: () => appendOutput(`<span class="info">Covenant 0.6</span>\nStarting Covenant C2...\n<span class="success">Covenant running on https://127.0.0.1:7443</span>`),
            sliver: () => appendOutput(`<span class="info">Sliver 1.5.41</span>\n\n    ███████╗██╗     ██╗██╗   ██╗███████╗██████╗\n    ██╔════╝██║     ██║██║   ██║██╔════╝██╔══██╗\n    ███████╗██║     ██║██║   ██║█████╗  ██████╔╝\n    ╚════██║██║     ██║╚██╗ ██╔╝██╔══╝  ██╔══██╗\n    ███████║███████╗██║ ╚████╔╝ ███████╗██║  ██║\n    ╚══════╝╚══════╝╚═╝  ╚═══╝  ╚══════╝╚═╝  ╚═╝\n\nsliver >`),
            'sliver-server': () => packageCommandHandlers.sliver(),

            // Sniffing & Spoofing
            ettercap: (args) => appendOutput(`<span class="info">Ettercap 0.8.3.1</span>\n${args.includes('-G') ? 'Starting GUI...\n<span class="success">Ettercap GTK launched!</span>' : 'Starting text mode...\n<span class="success">Ettercap running!</span>\nListening on eth0...'}`),
            'ettercap-graphical': () => packageCommandHandlers.ettercap(['-G']),

            bettercap: (args) => appendOutput(`<span class="info">bettercap 2.32.0</span>

<span class="success">██████╗ ███████╗████████╗████████╗███████╗██████╗  ██████╗ █████╗ ██████╗ 
██╔══██╗██╔════╝╚══██╔══╝╚══██╔══╝██╔════╝██╔══██╗██╔════╝██╔══██╗██╔══██╗
██████╔╝█████╗     ██║      ██║   █████╗  ██████╔╝██║     ███████║██████╔╝
██╔══██╗██╔══╝     ██║      ██║   ██╔══╝  ██╔══██╗██║     ██╔══██║██╔═══╝ 
██████╔╝███████╗   ██║      ██║   ███████╗██║  ██║╚██████╗██║  ██║██║     
╚═════╝ ╚══════╝   ╚═╝      ╚═╝   ╚══════╝╚═╝  ╚═╝ ╚═════╝╚═╝  ╚═╝╚═╝</span>

eth0 > `),

            responder: (args) => appendOutput(`<span class="info">Responder 3.1.3</span>
${args.length ? `
<span class="success">[+]</span> Listening on eth0...
<span class="warning">[*]</span> [LLMNR]  Poisoned answer sent to 192.168.1.50
<span class="success">[+]</span> [SMB] NTLMv2-SSP Hash captured:
    admin::DOMAIN:1122334455667788:...` : 'Usage: responder -I <interface>'}`),

            tcpdump: (args) => appendOutput(`<span class="info">tcpdump 4.99.4</span>
${args.length ? `listening on ${args.find(a => !a.startsWith('-')) || 'eth0'}
12:00:01.123456 IP 192.168.1.100.443 > 192.168.1.1.54321: Flags [S], seq 123456
12:00:01.234567 IP 192.168.1.1.54321 > 192.168.1.100.443: Flags [S.], seq 234567
12:00:01.345678 IP 192.168.1.100.443 > 192.168.1.1.54321: Flags [.], ack 1` : 'Usage: tcpdump -i <interface>'}`),

            dsniff: (args) => appendOutput(`<span class="info">dsniff 2.4</span>\n<span class="success">Listening on eth0...</span>`),
            arpspoof: (args) => appendOutput(`<span class="info">arpspoof</span>\n${args.length ? '<span class="success">Spoofing ARP replies...</span>' : 'Usage: arpspoof -i <iface> -t <target> <gateway>'}`),
            dnsspoof: (args) => appendOutput(`<span class="info">dnsspoof</span>\n${args.length ? '<span class="success">Spoofing DNS replies...</span>' : 'Usage: dnsspoof -i <iface>'}`),
            tcpkill: (args) => appendOutput(`<span class="info">tcpkill</span>\n${args.length ? '<span class="success">Killing connections...</span>' : 'Usage: tcpkill -i <iface> <expression>'}`),

            mitmproxy: () => appendOutput(`<span class="info">mitmproxy 10.2.2</span>\n<span class="success">Proxy server listening on http://0.0.0.0:8080</span>`),
            mitmdump: (args) => appendOutput(`<span class="info">mitmdump 10.2.2</span>\n<span class="success">Proxy started on 0.0.0.0:8080</span>`),
            mitmweb: () => appendOutput(`<span class="info">mitmweb 10.2.2</span>\n<span class="success">Web interface: http://127.0.0.1:8081</span>`),

            scapy: () => appendOutput(`<span class="info">Scapy 2.5.0</span>\n>>> <span class="success">Welcome to Scapy</span>\n>>> `),

            yersinia: (args) => appendOutput(`<span class="info">Yersinia 0.8.2</span>\n${args.includes('-G') ? 'Starting GUI...' : 'Starting interactive mode...'}\n<span class="success">Yersinia ready!</span>`),

            macchanger: (args) => {
                if (!args.length) appendOutput(`<span class="info">macchanger 1.7.0</span>\nUsage: macchanger [options] <interface>`);
                else appendOutput(`<span class="info">macchanger</span>\nCurrent MAC:   00:11:22:33:44:55 (Unknown)\n<span class="success">New MAC:       ${Array(6).fill(0).map(() => Math.floor(Math.random()*256).toString(16).padStart(2,'0')).join(':')} (Unknown)</span>`);
            },

            hping3: (args) => appendOutput(`<span class="info">hping3</span>\n${args.length ? `HPING ${args[0]} (eth0 ${args[0]}): S set, 40 headers + 0 data bytes\n<span class="success">len=46 ip=${args[0]} ttl=64 flags=SA seq=0 win=65535</span>` : 'Usage: hping3 <host> [options]'}`),

            // Post Exploitation
            mimikatz: () => appendOutput(`<span class="info">mimikatz 2.2.0</span>

  .#####.   mimikatz 2.2.0 (x64)
 .## ^ ##.  "A La Vie, A L'Amour"
 ## / \\ ##  
 ## \\ / ##  Benjamin DELPY
 '## v ##'  
  '#####'   

mimikatz # <span class="success">sekurlsa::logonpasswords</span>

Authentication Id : 0 ; 999 (00000000:000003e7)
User Name         : Administrator
Domain            : DOMAIN
        NTLM      : 31d6cfe0d16ae931b73c59d7e0c089c0
        SHA1      : da39a3ee5e6b4b0d3255bfef95601890afd80709`),

            empire: () => appendOutput(`<span class="info">Empire 5.9.0</span>

<span class="success">    ███████╗███╗   ███╗██████╗ ██╗██████╗ ███████╗
    ██╔════╝████╗ ████║██╔══██╗██║██╔══██╗██╔════╝
    █████╗  ██╔████╔██║██████╔╝██║██████╔╝█████╗  
    ██╔══╝  ██║╚██╔╝██║██╔═══╝ ██║██╔══██╗██╔══╝  
    ███████╗██║ ╚═╝ ██║██║     ██║██║  ██║███████╗
    ╚══════╝╚═╝     ╚═╝╚═╝     ╚═╝╚═╝  ╚═╝╚══════╝</span>

(Empire) >`),
            'powershell-empire': () => packageCommandHandlers.empire(),

            powersploit: () => appendOutput(`<span class="info">PowerSploit 3.0.0</span>\nModules loaded:\n  Get-GPPPassword\n  Invoke-Mimikatz\n  Invoke-TokenManipulation\n  PowerUp\n  PowerView`),

            bloodhound: () => appendOutput(`<span class="info">BloodHound 4.3.1</span>\nStarting BloodHound GUI...\n<span class="success">BloodHound launched!</span>\nNeo4j: bolt://localhost:7687`),

            sharphound: (args) => appendOutput(`<span class="info">SharpHound 2.3.2</span>\n${args.length ? 'Collecting Active Directory data...\n<span class="success">Collection complete! Output: bloodhound.zip</span>' : 'Usage: sharphound -c All'}`),

            linpeas: () => appendOutput(`<span class="info">LinPEAS 1.0</span>\n<span class="success">
▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓
▓                                    ▓
▓  LinPEAS - Linux Privilege         ▓
▓  Escalation Awesome Scripts        ▓
▓                                    ▓
▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓</span>

<span class="warning">[+] SUID binaries:</span>
    /usr/bin/sudo
    /usr/bin/passwd

<span class="error">[!] Possible privesc:</span>
    CVE-2021-4034 (PwnKit)`),

            winpeas: () => appendOutput(`<span class="info">WinPEAS 1.0</span>\n<span class="success">Windows Privilege Escalation Awesome Script</span>\n\n<span class="warning">[+] Checking AlwaysInstallElevated...</span>\n<span class="error">[!] AlwaysInstallElevated is enabled!</span>`),

            pspy: () => appendOutput(`<span class="info">pspy 1.2.1</span>\nMonitoring processes...\n\n<span class="success">CMD: UID=0    PID=1234  | /bin/bash /root/backup.sh</span>\n<span class="success">CMD: UID=0    PID=1235  | /usr/sbin/cron</span>`),

            chisel: (args) => appendOutput(`<span class="info">Chisel 1.9.1</span>\n${args[0] === 'server' ? '<span class="success">server: Listening on 0.0.0.0:8080</span>' : args[0] === 'client' ? '<span class="success">client: Connected!</span>' : 'Usage: chisel server|client [options]'}`),

            'ligolo-ng': (args) => appendOutput(`<span class="info">Ligolo-ng 0.5.1</span>\n<span class="success">Tunnel established!</span>`),

            // Forensics
            autopsy: () => appendOutput(`<span class="info">Autopsy 4.21.0</span>\nStarting Autopsy...\n<span class="success">Autopsy Forensic Browser launched!</span>`),

            binwalk: (args) => {
                if (!args.length) appendOutput(`<span class="info">Binwalk 2.3.4</span>\nUsage: binwalk [options] <file>`);
                else appendOutput(`<span class="info">Binwalk 2.3.4</span>

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             ELF, 64-bit LSB executable
512           0x200           Zlib compressed data
1024          0x400           JPEG image data
2048          0x800           PNG image`);
            },

            foremost: (args) => appendOutput(`<span class="info">Foremost 1.5.7</span>\n${args.length ? 'Processing file...\n<span class="success">Recovered 15 files!</span>' : 'Usage: foremost -i <image> -o <output>'}`),

            volatility: (args) => {
                if (!args.length) appendOutput(`<span class="info">Volatility 3.2.0</span>\nUsage: volatility -f <memory_dump> <plugin>\n\nPlugins:\n  windows.pslist\n  windows.pstree\n  windows.cmdline\n  windows.hashdump\n  linux.pslist`);
                else appendOutput(`<span class="info">Volatility 3.2.0</span>\n\nPID    PPID   Name\n----   ----   ----\n4      0      System\n88     4      Registry\n456    4      smss.exe\n567    456    csrss.exe\n678    456    wininit.exe`);
            },
            vol: (args) => packageCommandHandlers.volatility(args),
            vol3: (args) => packageCommandHandlers.volatility(args),
            volatility3: (args) => packageCommandHandlers.volatility(args),

            fls: (args) => appendOutput(`<span class="info">fls (Sleuth Kit)</span>\n${args.length ? 'd/d 11:\troot\nr/r 12:\tfile1.txt\nr/r 13:\tfile2.doc' : 'Usage: fls <image>'}`),
            icat: (args) => appendOutput(`<span class="info">icat (Sleuth Kit)</span>\n${args.length ? '<file contents extracted>' : 'Usage: icat <image> <inode>'}`),
            mmls: (args) => appendOutput(`<span class="info">mmls (Sleuth Kit)</span>\n${args.length ? 'DOS Partition Table\nOffset: 0\n\n      Start        End          Length       Description\n000:  0            0            1            Primary (0x83)\n001:  1            1000000      999999       Linux (0x83)' : 'Usage: mmls <image>'}`),

            testdisk: () => appendOutput(`<span class="info">TestDisk 7.2</span>\nStarting TestDisk...\n<span class="success">TestDisk launched!</span>`),
            photorec: () => appendOutput(`<span class="info">PhotoRec 7.2</span>\nStarting PhotoRec...\n<span class="success">PhotoRec launched!</span>`),

            scalpel: (args) => appendOutput(`<span class="info">Scalpel 2.0</span>\n${args.length ? 'Carving files...\n<span class="success">Recovered 23 files!</span>' : 'Usage: scalpel -c <config> -o <output> <image>'}`),

            bulk_extractor: (args) => appendOutput(`<span class="info">bulk_extractor 2.0.0</span>\n${args.length ? 'Scanning image...\n<span class="success">Extraction complete!</span>\nFound: emails, URLs, credit cards' : 'Usage: bulk_extractor -o <output> <image>'}`),

            exiftool: (args) => {
                if (!args.length) appendOutput(`<span class="info">ExifTool 12.76</span>\nUsage: exiftool <file>`);
                else appendOutput(`<span class="info">ExifTool 12.76</span>\nFile Name           : ${args[0]}\nFile Size           : 1.5 MB\nFile Type           : JPEG\nMIME Type           : image/jpeg\nCamera Model        : Canon EOS 5D\nGPS Latitude        : 40.7128 N\nGPS Longitude       : 74.0060 W\nCreate Date         : 2024:03:15 12:30:00`);
            },

            steghide: (args) => {
                if (!args.length) appendOutput(`<span class="info">Steghide 0.5.1</span>\nUsage: steghide embed|extract -sf <file>`);
                else if (args[0] === 'extract') appendOutput(`<span class="info">Steghide</span>\nEnter passphrase:\n<span class="success">wrote extracted data to "secret.txt"</span>`);
                else appendOutput(`<span class="info">Steghide</span>\n<span class="success">embedding done!</span>`);
            },

            stegseek: (args) => appendOutput(`<span class="info">Stegseek 0.6</span>\n${args.length ? '<span class="success">[i] Found passphrase: "password123"</span>\n[i] Extracting to output.txt' : 'Usage: stegseek <file> <wordlist>'}`),

            zsteg: (args) => appendOutput(`<span class="info">zsteg 0.2.12</span>\n${args.length ? 'b1,lsb,bY: <span class="success">secret message here</span>\nb1,msb,bY: [nothing]\nb2,lsb,bY: [nothing]' : 'Usage: zsteg <image.png>'}`),

            // Reverse Engineering
            ghidra: () => appendOutput(`<span class="info">Ghidra 11.0.1</span>\nStarting Ghidra...\n<span class="success">Ghidra launched!</span>\nLoading CodeBrowser...`),
            ghidraRun: () => packageCommandHandlers.ghidra(),

            radare2: (args) => appendOutput(`<span class="info">radare2 5.8.8</span>\n${args.length ? `[0x00000000]> ` : 'Usage: r2 <binary>'}`),
            r2: (args) => packageCommandHandlers.radare2(args),

            gdb: (args) => appendOutput(`<span class="info">GNU gdb 14.1</span>\n${args.length ? `Reading symbols from ${args[0]}...\n(gdb) ` : 'Usage: gdb <binary>'}`),

            peda: () => appendOutput(`<span class="info">PEDA - Python Exploit Development Assistance for GDB</span>\ngdb-peda$ `),
            gef: () => appendOutput(`<span class="info">GEF - GDB Enhanced Features</span>\ngef> `),
            pwndbg: () => appendOutput(`<span class="info">pwndbg</span>\npwndbg> `),

            rizin: (args) => appendOutput(`<span class="info">Rizin 0.7.2</span>\n${args.length ? '[0x00000000]> ' : 'Usage: rizin <binary>'}`),
            'rz-bin': (args) => appendOutput(`<span class="info">rz-bin</span>\n${args.length ? 'arch     x86\nbits     64\nos       linux' : 'Usage: rz-bin -I <binary>'}`),

            cutter: () => appendOutput(`<span class="info">Cutter 2.3.2</span>\nStarting Cutter GUI...\n<span class="success">Cutter launched!</span>`),

            apktool: (args) => {
                if (!args.length) appendOutput(`<span class="info">Apktool 2.9.3</span>\nUsage: apktool d|b <apk>`);
                else appendOutput(`<span class="info">Apktool 2.9.3</span>\n${args[0] === 'd' ? '<span class="success">Decompiling APK...</span>\nOutput: ./output/' : '<span class="success">Building APK...</span>'}`);
            },

            jadx: (args) => appendOutput(`<span class="info">JADX 1.4.7</span>\n${args.length ? '<span class="success">Decompiling...</span>\nOutput saved!' : 'Usage: jadx <apk>'}`),
            'jadx-gui': () => appendOutput(`<span class="info">JADX-GUI 1.4.7</span>\nStarting GUI...\n<span class="success">JADX GUI launched!</span>`),

            objdump: (args) => appendOutput(`<span class="info">objdump</span>\n${args.length ? `${args.find(a => !a.startsWith('-')) || 'binary'}:     file format elf64-x86-64\n\nDisassembly:\n0000000000001000 <main>:\n  1000: 55           push   %rbp\n  1001: 48 89 e5     mov    %rsp,%rbp` : 'Usage: objdump -d <binary>'}`),

            strace: (args) => appendOutput(`<span class="info">strace 6.7</span>\n${args.length ? 'execve("./program", ...) = 0\nbrk(NULL) = 0x5555555000\nmmap(...) = 0x7ffff7ff0000' : 'Usage: strace <program>'}`),

            ltrace: (args) => appendOutput(`<span class="info">ltrace 0.7.3</span>\n${args.length ? 'printf("Hello World") = 11\nmalloc(1024) = 0x5555555550' : 'Usage: ltrace <program>'}`),

            // Reporting
            dradis: () => appendOutput(`<span class="info">Dradis 4.11.0</span>\nStarting Dradis server...\n<span class="success">Dradis running on https://127.0.0.1:3000</span>`),

            faraday: () => appendOutput(`<span class="info">Faraday 5.1.0</span>\nStarting Faraday...\n<span class="success">Faraday IPE launched!</span>`),
            'faraday-server': () => appendOutput(`<span class="info">Faraday Server</span>\n<span class="success">Server running on http://localhost:5985</span>`),

            pipal: (args) => appendOutput(`<span class="info">Pipal 3.1</span>\n${args.length ? 'Analyzing passwords...\n\nTop 10 passwords:\n1. password (5%)\n2. 123456 (4%)\n3. admin (3%)' : 'Usage: pipal <wordlist>'}`),

            cherrytree: () => appendOutput(`<span class="info">CherryTree 1.0.4</span>\nStarting CherryTree...\n<span class="success">CherryTree launched!</span>`),

            // Social Engineering
            gophish: () => appendOutput(`<span class="info">Gophish 0.12.1</span>\nStarting Gophish...\n<span class="success">Gophish running!</span>\nAdmin: https://127.0.0.1:3333\nPhishing: http://127.0.0.1:8080`),

            'king-phisher': () => appendOutput(`<span class="info">King Phisher 1.14.0</span>\nStarting King Phisher...\n<span class="success">King Phisher server ready!</span>`),

            evilginx2: () => appendOutput(`<span class="info">Evilginx2 3.2.0</span>\n<span class="success">Evilginx2 started!</span>\n: phishlets\n: lures`),
            evilginx: () => packageCommandHandlers.evilginx2(),

            modlishka: () => appendOutput(`<span class="info">Modlishka 1.1.0</span>\n<span class="success">Reverse proxy started!</span>\nListening on :443`),

            // Cloud Security
            cloudsploit: (args) => appendOutput(`<span class="info">CloudSploit 3.0.0</span>\n${args.length ? 'Scanning cloud resources...\n<span class="warning">[WARN]</span> S3 bucket public\n<span class="error">[FAIL]</span> Root account MFA disabled' : 'Usage: cloudsploit scan'}`),

            prowler: (args) => appendOutput(`<span class="info">Prowler 4.0.0</span>\n${args.length ? 'Running security checks...\n\n<span class="success">[PASS]</span> IAM password policy\n<span class="warning">[WARN]</span> CloudTrail not enabled\n<span class="error">[FAIL]</span> S3 bucket encryption' : 'Usage: prowler <cloud>'}`),

            scout: (args) => appendOutput(`<span class="info">ScoutSuite 5.14.0</span>\n${args.length ? 'Gathering data...\n<span class="success">Report generated!</span>\nOpen: scout-report/index.html' : 'Usage: scout aws|azure|gcp'}`),
            scoutsuite: (args) => packageCommandHandlers.scout(args),

            pacu: () => appendOutput(`<span class="info">Pacu 1.5.0</span>\n<span class="success">
 ___  _   ___ _   _
| _ \\/_\\ / __| | | |
|  _/ _ \\ (__| |_| |
|_|/_/ \\_\\___|\\___/ 

AWS Exploitation Framework</span>

Pacu > `),

            cloudfox: (args) => appendOutput(`<span class="info">CloudFox 1.13.0</span>\n${args.length ? 'Enumerating AWS...\n<span class="success">Found 15 attack paths!</span>' : 'Usage: cloudfox aws <command>'}`),
        };

        // Built-in commands (always available)
        const builtinCommands = {
            help: () => appendOutput(`
<span class="info">Available Commands:</span>

  <span class="success">Navigation:</span>     ls, cd, pwd
  <span class="success">Files:</span>          cat, touch, mkdir, rm, cp, mv
  <span class="success">Text:</span>           echo, grep
  <span class="success">System:</span>         uname, whoami, hostname, date, uptime, free, df, ps, top
  <span class="success">Package Mgr:</span>    pacman -S/-R/-Ss/-Q/-Syu
  <span class="success">Utilities:</span>      clear, history, env, export, alias, which, man, sudo

<span class="warning">Install packages with:</span> pacman -S <package>
<span class="warning">Search packages with:</span> pacman -Ss <query>

<span class="error">═══════════════════════════════════════════════════════════════</span>
<span class="error">                    KALI LINUX SECURITY TOOLS                   </span>
<span class="error">═══════════════════════════════════════════════════════════════</span>

<span class="info">Information Gathering:</span>
  nmap, maltego, recon-ng, theharvester, shodan, spiderfoot,
  amass, subfinder, masscan, dmitry, fierce, whatweb, wafw00f

<span class="info">Vulnerability Analysis:</span>
  nikto, openvas, nessus, wpscan, sqlmap, nuclei, trivy, lynis

<span class="info">Web Application:</span>
  burpsuite, zaproxy, gobuster, dirb, wfuzz, ffuf, feroxbuster,
  httpx, katana, arjun

<span class="info">Password Attacks:</span>
  john, hashcat, hydra, medusa, cewl, crunch, ophcrack, ncrack

<span class="info">Wireless Attacks:</span>
  aircrack-ng, airodump-ng, aireplay-ng, kismet, wifite, reaver,
  bully, fern-wifi-cracker, fluxion

<span class="info">Exploitation:</span>
  metasploit (msfconsole, msfvenom), beef-xss, searchsploit,
  setoolkit, crackmapexec, evil-winrm, impacket-*, sliver

<span class="info">Sniffing & Spoofing:</span>
  ettercap, bettercap, responder, tcpdump, mitmproxy, scapy,
  arpspoof, dnsspoof, macchanger, hping3

<span class="info">Post Exploitation:</span>
  mimikatz, empire, bloodhound, linpeas, winpeas, chisel

<span class="info">Forensics:</span>
  autopsy, binwalk, foremost, volatility, sleuthkit, testdisk,
  exiftool, steghide, stegseek

<span class="info">Reverse Engineering:</span>
  ghidra, radare2, gdb, rizin, cutter, apktool, jadx, objdump

<span class="info">Social Engineering:</span>
  gophish, king-phisher, evilginx2, modlishka

<span class="info">Cloud Security:</span>
  prowler, scoutsuite, pacu, cloudfox, cloudsploit

<span class="error">═══════════════════════════════════════════════════════════════</span>

<span class="info">Popular packages:</span> htop, docker, nginx, code, firefox, nodejs, python...
<span class="info">After installing, just type the command name to use it!</span>
`),

            ls: (args) => {
                const flags = args.filter(a => a.startsWith('-')).join('');
                const target = args.find(a => !a.startsWith('-')) || '.';
                const path = resolvePath(target);
                const node = getNode(path);
                if (!node) { appendOutput(`ls: cannot access '${target}': No such file or directory`, 'error'); return; }
                if (node.type !== 'dir') { appendOutput(target); return; }
                const showHidden = flags.includes('a');
                const longFormat = flags.includes('l');
                let items = showHidden ? ['.', '..', ...node.children] : node.children.filter(i => !i.startsWith('.'));
                if (longFormat) {
                    appendOutput('total ' + items.length);
                    items.forEach(item => {
                        const itemPath = path === '/' ? '/' + item : path + '/' + item;
                        const itemNode = getNode(itemPath);
                        const isDir = item === '.' || item === '..' || (itemNode && itemNode.type === 'dir');
                        const perms = isDir ? 'drwxr-xr-x' : '-rw-r--r--';
                        const size = itemNode?.content?.length || 4096;
                        const colorClass = isDir ? 'directory' : item.endsWith('.py') || item.endsWith('.sh') ? 'executable' : 'file';
                        appendOutput(`${perms}  1 arch arch ${String(size).padStart(5)} Mar 15 12:00 <span class="${colorClass}">${item}</span>`);
                    });
                } else {
                    appendOutput(items.map(item => {
                        const itemPath = path === '/' ? '/' + item : path + '/' + item;
                        const itemNode = getNode(itemPath);
                        const isDir = item === '.' || item === '..' || (itemNode && itemNode.type === 'dir');
                        return `<span class="${isDir ? 'directory' : item.endsWith('.py') ? 'executable' : 'file'}">${item}</span>`;
                    }).join('  '));
                }
            },

            cd: (args) => {
                const target = args[0] || '~';
                const path = resolvePath(target);
                const node = getNode(path);
                if (!node) { appendOutput(`cd: ${target}: No such file or directory`, 'error'); return; }
                if (node.type !== 'dir') { appendOutput(`cd: ${target}: Not a directory`, 'error'); return; }
                currentPath = path;
                updatePrompt();
            },

            pwd: () => appendOutput(currentPath),

            cat: (args) => {
                if (!args.length) { appendOutput('cat: missing operand', 'error'); return; }
                const path = resolvePath(args[0]);
                const node = getNode(path);
                if (!node) { appendOutput(`cat: ${args[0]}: No such file or directory`, 'error'); return; }
                if (node.type === 'dir') { appendOutput(`cat: ${args[0]}: Is a directory`, 'error'); return; }
                appendRaw(node.content);
            },

            echo: (args) => {
                let text = args.join(' ').replace(/\$(\w+)/g, (m, v) => env[v] || '').replace(/^["']|["']$/g, '');
                appendOutput(text);
            },

            clear: () => { outputEl.innerHTML = ''; },

            uname: (args) => appendOutput(args.includes('-a') ? 'Linux archlinux 6.7.0-arch1-1 #1 SMP PREEMPT_DYNAMIC x86_64 GNU/Linux' : 'Linux'),
            whoami: () => appendOutput(username),
            hostname: () => appendOutput(hostname),
            date: () => appendOutput(new Date().toString()),
            uptime: () => appendOutput(` ${new Date().toLocaleTimeString()} up ${Math.floor(Math.random()*100)}:${Math.floor(Math.random()*60)}, 1 user, load average: 0.52, 0.58, 0.59`),
            free: () => appendOutput(`              total        used        free\nMem:       16384000     4521348     8234652\nSwap:       8192000           0     8192000`),
            df: () => appendOutput(`Filesystem     1K-blocks      Used Available Use% Mounted on\n/dev/sda1      244140625  48576432 195564193  20% /`),
            ps: () => appendOutput(`  PID TTY          TIME CMD\n    1 ?        00:00:02 systemd\n  234 ?        00:00:00 bash\n  567 pts/0    00:00:00 node`),
            top: () => appendOutput(`top - ${new Date().toLocaleTimeString()} up 4:32, 1 user\nTasks: 142 total,   1 running\n%Cpu(s):  5.2 us,  1.3 sy, 93.5 id\nMiB Mem:  16384.0 total,   4521.3 used\n\n  PID USER      %CPU %MEM COMMAND\n  567 arch       2.3  0.3 node\n  890 arch       0.7  0.1 vim`),

            touch: (args) => {
                if (!args[0]) { appendOutput('touch: missing operand', 'error'); return; }
                const path = resolvePath(args[0]);
                if (!fileSystem[path]) {
                    fileSystem[path] = { type: 'file', content: '' };
                    const parent = path.substring(0, path.lastIndexOf('/')) || '/';
                    if (fileSystem[parent]) fileSystem[parent].children.push(args[0]);
                }
            },

            mkdir: (args) => {
                if (!args[0]) { appendOutput('mkdir: missing operand', 'error'); return; }
                const path = resolvePath(args[0]);
                if (fileSystem[path]) { appendOutput(`mkdir: cannot create directory '${args[0]}': File exists`, 'error'); return; }
                fileSystem[path] = { type: 'dir', children: [] };
                const parent = path.substring(0, path.lastIndexOf('/')) || '/';
                if (fileSystem[parent]) fileSystem[parent].children.push(args[0]);
            },

            rm: (args) => {
                if (!args[0]) { appendOutput('rm: missing operand', 'error'); return; }
                const path = resolvePath(args[0]);
                if (!fileSystem[path]) { appendOutput(`rm: cannot remove '${args[0]}': No such file`, 'error'); return; }
                delete fileSystem[path];
            },

            history: () => commandHistory.forEach((cmd, i) => appendOutput(`  ${i + 1}  ${cmd}`)),
            env: () => Object.entries(env).forEach(([k, v]) => appendOutput(`${k}=${v}`)),
            export: (args) => { const m = args.join(' ').match(/^(\w+)=(.*)$/); if (m) env[m[1]] = m[2].replace(/^["']|["']$/g, ''); },
            alias: () => appendOutput(`alias ls='ls --color=auto'\nalias ll='ls -la'\nalias ..='cd ..'`),
            which: (args) => {
                if (!args[0]) { appendOutput('which: missing argument', 'error'); return; }
                const pkg = findPackageForCommand(args[0]);
                if (builtinCommands[args[0]]) appendOutput(`${args[0]}: shell built-in`);
                else if (pkg && installedPackages.has(pkg)) appendOutput(`/usr/bin/${args[0]}`);
                else appendOutput(`${args[0]} not found`, 'error');
            },
            man: (args) => {
                if (!args[0]) { appendOutput('What manual page do you want?', 'warning'); return; }
                appendOutput(`<span class="info">${args[0].toUpperCase()}(1)</span>                   User Commands\n\n<span class="success">NAME</span>\n       ${args[0]} - ${args[0]} command\n\n<span class="success">DESCRIPTION</span>\n       Manual page for ${args[0]}.\n\n<span class="success">SEE ALSO</span>\n       https://wiki.archlinux.org`);
            },
            sudo: (args) => {
                if (!args.length) { appendOutput('usage: sudo <command>', 'warning'); return; }
                appendOutput(`[sudo] password for ${username}: `);
                setTimeout(() => executeCommand(args.join(' ')), 300);
            },
            exit: () => { appendOutput('logout', 'warning'); setTimeout(() => document.body.innerHTML = '<div style="display:flex;justify-content:center;align-items:center;height:100vh;color:#1793d1;font-family:monospace;font-size:24px;">Session ended. Refresh to restart.</div>', 500); },
            reboot: () => { appendOutput('Rebooting...', 'warning'); setTimeout(() => location.reload(), 1000); },
            btw: () => appendOutput(`\n<span class="info">╔══════════════════════════════════════════╗\n║       BTW, I USE ARCH LINUX! 🐧          ║\n╚══════════════════════════════════════════╝</span>`),
            grep: (args) => appendOutput(args.length ? `grep: searching for '${args[0]}'...` : 'Usage: grep PATTERN [FILE]', args.length ? 'info' : 'warning'),

            pacman: (args) => {
                if (args[0] === '-Syu') {
                    inputEl.disabled = true;
                    appendOutput(`<span class="info">::</span> Synchronizing package databases...`);
                    ['core', 'extra', 'community'].forEach((repo, i) => {
                        setTimeout(() => appendOutput(` ${repo.padEnd(20)} ${(Math.random()*5+0.5).toFixed(1)} MiB  [######################] 100%`), 300*(i+1));
                    });
                    setTimeout(() => {
                        appendOutput(`<span class="info">::</span> Starting full system upgrade...`);
                        appendOutput(` there is nothing to do`, 'success');
                        inputEl.disabled = false;
                        inputEl.focus();
                    }, 1200);
                } else if (args[0] === '-S' && args[1]) {
                    const pkgName = args[1];
                    if (installedPackages.has(pkgName)) {
                        appendOutput(`<span class="warning">warning:</span> ${pkgName} is already installed -- reinstalling`);
                    }
                    const pkg = allPackages[pkgName] || { version: '1.0.0-1', size: (Math.random()*50+1).toFixed(1)+' MiB', desc: 'A package', commands: [pkgName] };
                    inputEl.disabled = true;
                    appendOutput(`<span class="info">::</span> Resolving dependencies...`);
                    setTimeout(() => {
                        appendOutput(`\n<span class="success">Packages (1)</span> ${pkgName}-${pkg.version}\nTotal Size: ${pkg.size}\n\n<span class="info">::</span> Proceed with installation? [Y/n]`);
                        setTimeout(() => {
                            appendOutput(`<span class="info">::</span> Retrieving packages...`);
                            let progress = 0;
                            const bar = document.createElement('div');
                            bar.className = 'output-line';
                            outputEl.appendChild(bar);
                            const interval = setInterval(() => {
                                progress += Math.random()*20+10;
                                if (progress >= 100) {
                                    progress = 100;
                                    clearInterval(interval);
                                    bar.innerHTML = ` ${pkgName}-${pkg.version}  [######################] 100%`;
                                    setTimeout(() => {
                                        appendOutput(`<span class="info">(1/1)</span> checking package integrity     [######################] 100%`);
                                        appendOutput(`<span class="info">(1/1)</span> loading package files          [######################] 100%`);
                                        appendOutput(`<span class="success">(1/1) installing ${pkgName}</span>              [######################] 100%`);
                                        
                                        // INSTALL THE PACKAGE
                                        installedPackages.add(pkgName);
                                        
                                        // Show available commands
                                        const cmds = pkg.commands || [pkgName];
                                        appendOutput(`\n<span class="success">:: ${pkgName} installed successfully!</span>`);
                                        appendOutput(`<span class="info">Available commands: ${cmds.join(', ')}</span>`);
                                        
                                        inputEl.disabled = false;
                                        inputEl.focus();
                                    }, 300);
                                } else {
                                    const filled = Math.floor(progress/100*22);
                                    bar.innerHTML = ` ${pkgName}-${pkg.version}  [${'#'.repeat(filled)}${'-'.repeat(22-filled)}] ${Math.floor(progress)}%`;
                                }
                                scrollToBottom();
                            }, 80);
                        }, 400);
                    }, 300);
                } else if (args[0] === '-R' && args[1]) {
                    const pkgName = args[1];
                    if (!installedPackages.has(pkgName)) {
                        appendOutput(`<span class="error">error:</span> target not found: ${pkgName}`, 'error');
                    } else {
                        appendOutput(`<span class="success">(1/1) removing ${pkgName}</span>              [######################] 100%`);
                        installedPackages.delete(pkgName);
                        appendOutput(`<span class="success">:: ${pkgName} removed successfully!</span>`);
                    }
                } else if (args[0] === '-Ss' && args[1]) {
                    const query = args[1].toLowerCase();
                    let found = false;
                    Object.entries(allPackages).forEach(([name, pkg]) => {
                        if (name.includes(query) || pkg.desc.toLowerCase().includes(query)) {
                            const installed = installedPackages.has(name) ? ' <span class="success">[installed]</span>' : '';
                            appendOutput(`<span class="info">extra/${name}</span> ${pkg.version}${installed}\n    ${pkg.desc}`);
                            found = true;
                        }
                    });
                    if (!found) appendOutput(`No packages found matching '${query}'`);
                } else if (args[0] === '-Q') {
                    [...installedPackages].sort().forEach(pkg => {
                        const info = allPackages[pkg];
                        appendOutput(`${pkg} ${info?.version || '1.0.0-1'}`);
                    });
                } else if (args[0] === '-Qs' && args[1]) {
                    const query = args[1].toLowerCase();
                    const matches = [...installedPackages].filter(p => p.includes(query));
                    if (matches.length) matches.forEach(pkg => appendOutput(`<span class="info">local/${pkg}</span> ${allPackages[pkg]?.version || '1.0.0-1'}`));
                    else appendOutput('error: no package found', 'error');
                } else {
                    appendOutput(`usage:  pacman <operation> [...]\n    pacman -S  <pkg>   install\n    pacman -R  <pkg>   remove\n    pacman -Ss <query> search\n    pacman -Q          list installed\n    pacman -Syu        upgrade`, 'warning');
                }
            },
        };

        function executeCommand(input) {
            const parts = input.trim().split(/\s+/);
            const cmd = parts[0];
            const args = parts.slice(1);

            if (!cmd) return;

            // 1. Check built-in commands first
            if (builtinCommands[cmd]) {
                builtinCommands[cmd](args);
                return;
            }

            // 2. Check if command is from an installed package
            const pkg = findPackageForCommand(cmd);
            if (pkg && installedPackages.has(pkg)) {
                // Package is installed, run the command
                if (packageCommandHandlers[cmd]) {
                    packageCommandHandlers[cmd](args);
                } else {
                    // Generic handler for commands without specific implementation
                    const pkgInfo = allPackages[pkg];
                    appendOutput(`<span class="info">${cmd}</span> from ${pkg} ${pkgInfo?.version || ''}\n<span class="success">Command executed!</span> (simulated)`);
                }
                return;
            }

            // 3. Command exists but package not installed
            if (pkg) {
                appendOutput(`bash: ${cmd}: command not found`, 'error');
                appendOutput(`<span class="info">Hint: Install with 'pacman -S ${pkg}'</span>`);
                return;
            }

            // 4. Check if there's a handler (for commands we know about but user hasn't installed)
            if (packageCommandHandlers[cmd]) {
                // Find which package provides this
                for (const [pkgName, pkgInfo] of Object.entries(allPackages)) {
                    if (pkgInfo.commands && pkgInfo.commands.includes(cmd)) {
                        appendOutput(`bash: ${cmd}: command not found`, 'error');
                        appendOutput(`<span class="info">Hint: Install with 'pacman -S ${pkgName}'</span>`);
                        return;
                    }
                }
            }

            // 5. Unknown command
            appendOutput(`bash: ${cmd}: command not found`, 'error');
        }

        function handleCommand(input) {
            const commandLine = document.createElement('div');
            commandLine.className = 'output-line';
            commandLine.innerHTML = getPrompt() + '<span style="color:#fff">' + input.replace(/</g, '&lt;').replace(/>/g, '&gt;') + '</span>';
            outputEl.appendChild(commandLine);

            if (input.trim()) {
                commandHistory.push(input);
                historyIndex = commandHistory.length;
            }

            executeCommand(input);
        }

        // Event Listeners
        inputEl.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                handleCommand(inputEl.value);
                inputEl.value = '';
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                if (historyIndex > 0) { historyIndex--; inputEl.value = commandHistory[historyIndex]; }
            } else if (e.key === 'ArrowDown') {
                e.preventDefault();
                if (historyIndex < commandHistory.length - 1) { historyIndex++; inputEl.value = commandHistory[historyIndex]; }
                else { historyIndex = commandHistory.length; inputEl.value = ''; }
            } else if (e.key === 'Tab') {
                e.preventDefault();
                const current = inputEl.value.split(' ').pop();
                const allCmds = [...Object.keys(builtinCommands), ...Object.keys(packageCommandHandlers)];
                const match = allCmds.find(c => c.startsWith(current));
                if (match) { const parts = inputEl.value.split(' '); parts[parts.length - 1] = match; inputEl.value = parts.join(' '); }
            } else if (e.key === 'l' && e.ctrlKey) {
                e.preventDefault();
                builtinCommands.clear();
            } else if (e.key === 'c' && e.ctrlKey) {
                e.preventDefault();
                appendOutput(getPrompt() + inputEl.value + '^C');
                inputEl.value = '';
            }
        });

        terminalBody.addEventListener('click', () => inputEl.focus());

        // Initialize
        updatePrompt();
        appendOutput(`<span class="info">Arch Linux 6.7.0-arch1-1 (tty1)</span>

Welcome to <span class="ascii-art">Arch Linux</span>!
Type <span class="success">'help'</span> for available commands.
Install packages with <span class="success">'pacman -S <package>'</span>
`);
        inputEl.focus();
    </script>
</body>
</html>
